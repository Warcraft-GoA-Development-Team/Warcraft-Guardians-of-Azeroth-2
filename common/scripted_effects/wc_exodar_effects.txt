create_characters_exodar_effect = {
	create_character = {
		template = velen_character_template
		location = title:c_valaar.title_province
		name = Velen
		save_scope_as = velen
	}
	create_character = {
		template = maraad_character_template
		location = title:c_valaar.title_province
		name = Maraad
		save_scope_as = maraad
	}
	create_character = {
		template = proenitus_character_template
		location = title:c_ammen_vale.title_province
		name = Proenitus
		save_scope_as = proenitus
	}
	create_character = {
		template = admetius_character_template
		location = title:c_ragefeather.title_province
		name = Admetius
		save_scope_as = admetius
	}
	create_character = {
		template = ishanah_character_template
		location = title:c_harnea.title_province
		name = Ishanah
		save_scope_as = ishanah
	}
	scope:velen = {
		save_scope_as = owner
		set_artifact_rarity_famed = yes
		really_make_important_lore_character_effect = yes
		create_artifact = {
			creator = scope:velen
			type = regalia
			visuals = naaru_staff
			name = naaru_staff.name
			description = naaru_staff.desc
			modifier = naaru_staff
			rarity = famed
			template = general_unique_template
			history = { type = created_before_history }
			save_scope_as = newly_created_artifact
		}
		scope:newly_created_artifact = { equip_artifact_to_owner = yes }
	}
	scope:maraad = {
		save_scope_as = owner
		set_artifact_rarity_masterwork = yes
		really_make_important_lore_character_effect = yes
		create_artifact = {
			creator = scope:maraad
			type = hammer
			visuals = naaru_hammer
			name = naaru_hammer.name
			description = naaru_hammer.desc
			modifier = naaru_hammer
			rarity = masterwork
			template = general_unique_template
			history = { type = created_before_history }
			save_scope_as = newly_created_artifact
		}
		scope:newly_created_artifact = { equip_artifact_to_owner = yes }
		
		set_artifact_rarity_common = yes
		create_artifact = {
			creator = scope:maraad
			type = miscellaneous
			visuals = maraad_memento
			name = maraad_memento.name
			description = maraad_memento.desc
			modifier = maraad_memento
			rarity = common
			template = general_unique_template
			history = { type = created_before_history }
			save_scope_as = newly_created_artifact
		}
		scope:newly_created_artifact = { equip_artifact_to_owner = yes }
	}
	scope:ishanah = { really_make_important_lore_character_effect = yes }
}

update_opinions_exodar_effect = {
	scope:velen = {
		add_opinion = {
			modifier = exodar_maraad
			target = scope:maraad
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:proenitus
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:admetius
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:ishanah
		}
	}
	scope:maraad = {
		add_opinion = {
			modifier = exodar_prophet
			target = scope:velen
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:proenitus
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:admetius
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:ishanah
		}
		add_gold = 50
	}
	scope:proenitus = {
		add_opinion = {
			modifier = exodar_prophet
			target = scope:velen
		}
		add_opinion = {
			modifier = exodar_maraad
			target = scope:maraad
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:admetius
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:ishanah
		}
		add_gold = 30
	}
	scope:admetius = {
		add_opinion = {
			modifier = exodar_prophet
			target = scope:velen
		}
		add_opinion = {
			modifier = exodar_maraad
			target = scope:maraad
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:proenitus
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:ishanah
		}
		add_gold = 35
	}
	scope:ishanah = {
		add_opinion = {
			modifier = exodar_prophet
			target = scope:velen
		}
		add_opinion = {
			modifier = exodar_maraad
			target = scope:maraad
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:admetius
		}
		add_opinion = {
			modifier = exodar_fellow_survivor
			target = scope:proenitus
		}
		add_gold = 25
	}
}

setup_titles_azuremyst_exodar_effect = {

	#Updating counties
	title:c_valaar = {
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
		change_development_level = -3
		change_county_control = -50
		add_exodar_crystal_mid_modifier = yes
	}
	title:b_valaar.title_province = {
		if = { 
			limit = { has_holding_type = tribal_holding }
			set_holding_type = castle_holding
		}
		add_special_building = exodar_01
	}
	title:c_yanra = {
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
		change_development_level = -2
		change_county_control = -25
		add_exodar_crystal_low_modifier = yes
		title_province = {
			if = { 
				limit = { has_holding_type = tribal_holding }
				set_holding_type = castle_holding
			}
		}
	}
	title:c_ammen_vale = {
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
		change_development_level = -2
		change_county_control = -25
		add_exodar_crystal_low_modifier = yes
		title_province = {
			if = { 
				limit = { has_holding_type = tribal_holding }
				set_holding_type = castle_holding
			}
		}
	}
	title:c_ragefeather = { 
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
		change_development_level = -5
		change_county_control = -75
		add_exodar_crystal_high_modifier = yes
		title_province = {
			if = { 
				limit = { has_holding_type = tribal_holding }
				set_holding_type = castle_holding
			}
		}
	}
	title:c_harnea = { 
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
		change_development_level = -3
		change_county_control = -50
		add_exodar_crystal_mid_modifier = yes
		title_province = {
			if = { 
				limit = { has_holding_type = tribal_holding }
				set_holding_type = castle_holding
			}
		}
	}
	title:c_mytanelle = { add_exodar_crystal_high_modifier = yes }
	title:c_mystwood = { add_exodar_crystal_high_modifier = yes }
	
	title:c_emberglade = { add_exodar_crystal_mid_modifier = yes }
	title:c_tedon = { add_exodar_crystal_mid_modifier = yes }
	title:c_fnyaess = { add_exodar_crystal_mid_modifier = yes }
	title:c_amberweb = { add_exodar_crystal_mid_modifier = yes }
	title:c_axxarien = { add_exodar_crystal_mid_modifier = yes }
	title:c_blacksilt_shore = { add_exodar_crystal_mid_modifier = yes }
	title:c_bladewood = { add_exodar_crystal_mid_modifier = yes }
	
	title:c_nestlewood = { add_exodar_crystal_low_modifier = yes }
	title:c_bristlelimb = { add_exodar_crystal_low_modifier = yes }
	title:c_moongraze = { add_exodar_crystal_low_modifier = yes }
	title:c_stillpine = { add_exodar_crystal_low_modifier = yes }
	title:c_blood_watch = { add_exodar_crystal_low_modifier = yes }
	title:c_loretharan = { add_exodar_crystal_low_modifier = yes }
	title:c_wrathscale = { add_exodar_crystal_low_modifier = yes }
	
	#Velen Head Of Faith
	create_title_and_vassal_change = {
		type = created
		save_scope_as = title_change
		add_claim_on_loss = yes
	}
	title:d_naaru = {
		change_title_holder_include_vassals = {
			holder = scope:velen
			change = scope:title_change
		}
	}
	
	#Maraad Head Of Exodar
	title:c_valaar = {
		change_title_holder_include_vassals = {
			holder = scope:maraad
			change = scope:title_change
		}
	}
	title:c_yanra = {
		change_title_holder_include_vassals = {
			holder = scope:maraad
			change = scope:title_change
		}
	}
	title:k_exodar = {
		change_title_holder = {
			holder = scope:maraad
			change = scope:title_change
		}
	}
	
	#Other Survivor groups of the Exodar
	#Nuraan
	create_dynamic_title = {
		tier = duchy
		name = exodar_group_1_title_name
	}
	scope:new_title = {
		set_capital_county = title:c_ammen_vale
		set_landless_title = yes
		set_no_automatic_claims = yes
		set_can_be_named_after_dynasty = no
		change_title_holder = {
			holder = scope:proenitus
			change = scope:title_change
		}
	}
	scope:new_title = { generate_coa = yes }
	title:c_ammen_vale = {
		change_title_holder_include_vassals = {
			holder = scope:proenitus
			change = scope:title_change
		}
	}
	
	#Salaar
	create_dynamic_title = {
		tier = duchy
		name = exodar_group_2_title_name
	}
	scope:new_title = {
		set_capital_county = title:c_ragefeather
		set_landless_title = yes
		set_no_automatic_claims = yes
		set_can_be_named_after_dynasty = no
		change_title_holder = {
			holder = scope:admetius
			change = scope:title_change
		}
	}
	scope:new_title = { generate_coa = yes }
	title:c_ragefeather = {
		change_title_holder_include_vassals = {
			holder = scope:admetius
			change = scope:title_change
		}
	}
	
	#Lightsworn
	create_dynamic_title = {
		tier = duchy
		name = exodar_group_3_title_name
	}
	scope:new_title = {
		set_capital_county = title:c_harnea
		set_landless_title = yes
		set_no_automatic_claims = yes
		set_can_be_named_after_dynasty = no
		change_title_holder = {
			holder = scope:ishanah
			change = scope:title_change
		}
	}
	scope:new_title = { generate_coa = yes }
	title:c_harnea = {
		change_title_holder_include_vassals = {
			holder = scope:ishanah
			change = scope:title_change
		}
	}
	resolve_title_and_vassal_change = scope:title_change
	
	scope:ishanah = { primary_title = { set_color_from_title = title:k_exodar } }
	scope:admetius = { primary_title = { set_color_from_title = title:k_exodar } }
	scope:proenitus = { primary_title = { set_color_from_title = title:k_exodar } }
}
add_exodar_crystal_high_modifier = {
	add_county_modifier = {
		modifier = wc_exodar_crystal_high
		years = { 4 7 }
	}
}
add_exodar_crystal_mid_modifier = {
	add_county_modifier = {
		modifier = wc_exodar_crystal_mid
		years = { 4 7 }
	}
}
add_exodar_crystal_low_modifier = {
	add_county_modifier = {
		modifier = wc_exodar_crystal_low
		years = { 4 7 }
	}
}

setup_base_army_exodar_effect = {
	scope:maraad = { trigger_event = exodar.1005 }
	scope:ishanah = { trigger_event = exodar.1006 }
	scope:admetius = { trigger_event = exodar.1007 }
	scope:proenitus = { trigger_event = exodar.1008 }
}
