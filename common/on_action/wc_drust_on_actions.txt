#### Yearly check to see if Drust event can begin
yearly_global_pulse = { on_actions = { heartsbane_check } }

heartsbane_check = {
	trigger = {
		title:d_drustwar.holder ?= {
			NOT = { has_global_variable = drust_incursion_happened }
			NOT = { has_global_variable = heartsbane_coven_event_var }

			exists = title:k_kul_tiras.holder
			highest_held_title_tier < tier_kingdom

			trigger_if = {
				limit = { drust_sick_spouse_trigger = yes }
				any_spouse = { drust_worried_spouse_trigger = yes }
			}
			trigger_else = {
				drust_worried_spouse_trigger = yes
				any_spouse = { drust_sick_spouse_trigger = yes }
			}
		}
	}
	effect = {
		title:d_drustwar.holder ?= {
			set_global_variable = heartsbane_coven_event_var
			set_global_variable = drustvar_crisis_ongoing_var    # Blocks summon_gorak_tul

			# Picks who is sick and who isn't
			if = {
				limit = { drust_sick_spouse_trigger = yes }
				save_scope_as = sick_spouse
				random_spouse = {
					limit = { drust_worried_spouse_trigger = yes }
					save_scope_as = worried_spouse
				}
			}
			else = {
				save_scope_as = worried_spouse
				random_spouse = {
					limit = { drust_sick_spouse_trigger = yes }
					save_scope_as = sick_spouse
				}
			}

			scope:worried_spouse = { trigger_event = drust_crisis.1 }
		}
	}
}

on_title_lost = {
	on_actions = {
		wc_drust_incursion_on_actions
	}
}

wc_drust_incursion_on_actions = {
	effect = {
		if = {
			limit = {
				scope:title = title:c_boralus
				scope:new_holder = { is_from_the_drust_trigger = yes }
			}
			scope:new_holder = {
				trigger_event = {
					id = drust_crisis.10
					days = 7
				}
			}
		}
	}
}