story_frozen_throne_war = {
	on_setup = {
		set_illidari_characters_effect = yes
		# The Illidari declare war on the Lich King
		declare_war_on_lich_king_effect = yes
		
		story_owner = { add_character_modifier = { modifier = great_invader_modifier } }
	}

	on_end = {
		story_owner = { remove_character_modifier = great_invader_modifier }
		if = {
			limit = { exists = title:k_illidari.holder }
			# title:k_illidari.holder = { trigger_event = WCHOI.3 }
		}
		debug_log = "Frozen Throne story ended on:"
		debug_log_date = yes
		set_global_variable = {
			name = frozen_throne_story_has_ended
			value = yes
		}
	}

	# If Illidan dies, the story ends
	on_owner_death = { end_story = yes }
	
	# Story handling in case of succession weirdness
	effect_group = {
		days = 180

		trigger = {
			story_owner = {
				NOT = {
					any_held_title = {
						this = title:k_illidari
					}
				}
			}
		}

		triggered_effect = {
			trigger = { NOT = { exists = title:k_illidari.holder } }
			effect = {
				end_story = yes
			}
		}
	}
}
