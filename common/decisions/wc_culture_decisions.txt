build_cosmic_observatory_decision = { 
	picture = "gfx/interface/illustrations/decisions/decision_realm.dds" #TODO
	major = yes

	ai_check_interval = 36

	desc = build_cosmic_observatory_decision_desc

	is_shown = {
		NOT = { 
			top_liege = { 
				any_sub_realm_county = {
					has_special_building_slot = cosmic_observatory
				}
			}
		}
		
		is_landed = yes
		culture = { has_cultural_pillar = heritage_highborne }
		NOT = { 
			is_target_in_variable_list = {
				name = unavailable_unique_decisions
				target = flag:build_cosmic_observatory_decision
			}
		}
		OR = { # Show it earlier so it's something to work towards
			has_trait = lifestyle_mystic
			has_trait = education_learning
		}
		# MAGIC 2024 TODO: void magic pathway
	}

	is_valid = {
		highest_held_title_tier >= tier_duchy
		has_trait = lifestyle_mystic
		OR = { 
			has_trait = education_learning_5
			AND = { 
				OR = { 
					has_trait = education_learning_3
					has_trait = education_learning_4
				}
				has_trait = scholar
			}
			# MAGIC 2024 TODO: void magic pathway
		}
	}

	widget = {
		controller = create_holy_order
		gui = "decision_view_widget_place_special_building"
		barony_valid = {
			OR = {
				holder = scope:ruler
				AND = { 
					holder.primary_title.tier = tier_barony
					exists = holder.liege
					holder.liege = scope:ruler
				}
			}
			title_province = {
				has_special_building = no
				has_special_building_slot = no
			}
		}
	}

	effect = {
		add_to_variable_list = {
			name = unavailable_unique_decisions
			target = flag:build_cosmic_observatory_decision
		}

		scope:barony ?= {
			title_province = {
				add_special_building_slot = cosmic_observatory
			}
		}
		
		add_character_flag = can_build_observatory
	}
}
