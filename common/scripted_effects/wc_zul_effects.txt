create_empire_of_zul_effect = {
	spawn_zulian_troops_effect = yes 
	#Set max authority
	if = {
		limit = { has_realm_law_flag = uses_crown_authority }
		add_realm_law = crown_authority_3
	}
	if = {
		limit = { has_realm_law_flag = uses_tribal_authority }
		add_realm_law = tribal_authority_3
	}
	if = {
		limit = { realm_law_use_dark_frenzy_trigger = yes }
		change_dark_frenzy_effect = { VALUE = 50 }
	}

	save_scope_as = founder

	#Create the title 
	create_title_and_vassal_change = {
		type = created
		save_scope_as = change
		add_claim_on_loss = no
	}

	title:e_empire_of_zul = {
		change_title_holder = {
			holder = root
			change = scope:change
		}
		set_definitive_form = yes
	}

	resolve_title_and_vassal_change = scope:change
	set_primary_title_to = title:e_empire_of_zul 
	title:e_empire_of_zul = { custom_tooltip = create_empire_of_zul_titles_tt } #Scope change for tooltip formatting.
	
	# Change primary title of holder (if exists)
	hidden_effect = {
		# Destroy other troll empire titles (if they exist)
		# Create List
		title:e_amani = { add_to_list = zulian_empires }
		title:e_drakkari = { add_to_list = zulian_empires }
		title:e_gurubashi = { add_to_list = zulian_empires }
		title:e_zandalari = { add_to_list = zulian_empires }
		title:e_zulfarrak = { add_to_list = zulian_empires }
		
		every_in_list = {
			list = zulian_empires
			save_scope_as = empire_title
			if = {
				limit = { 
					OR = {
						NOT = { exists = scope:empire_title.holder }
						scope:empire_title.holder = scope:founder 
					}
				}
				# set dejure liege to zul
				every_in_de_jure_hierarchy = {
					limit = {
						tier = tier_kingdom
					}
					set_de_jure_liege_title = title:e_empire_of_zul
				}
				# Destroy any active troll empires i own
				if = { limit = { scope:empire_title.holder = scope:founder } scope:founder = { destroy_title = scope:empire_title } } 
			}		
		}
	}
	
}

spawn_zulian_troops_effect = {
	if = {
		limit = { exists = capital_province }
		spawn_army = { # 4000
			uses_supply = no
			inheritable = yes
			name = zulian_elite_troops_name
			levies = 900
			men_at_arms = { # 400
				type = war_dinosaur
				stacks = 8
			}
			men_at_arms = { # 600
				type = dire_troll
				stacks = 12
			}
			men_at_arms = { # 900
				type = witch_doctor
				stacks = 12
			}
			men_at_arms = { # 900
				type = headhunter
				stacks = 6
			}
			men_at_arms = { # 100
				type = mangonel
				stacks = 10
			}
			men_at_arms = { # 100
				type = armored_horsemen
				stacks = 10
			}
			location = root.capital_province
			origin = root.capital_province
		}
	}
}

swear_fealty_to_zul_effect = {
	if = {
		limit = {
			highest_held_title_tier = tier_empire
		}
		primary_title = { save_scope_as = empire }
		random_kingdom = {
			limit = { holder = root }
			weight = {
				value = 1000
				if = {
					limit = {
						is_de_jure_liege_or_above_target = title:e_empire_of_zul
					}
					multiply = 3
				}
			}
			save_scope_as = new_title
		}
		set_primary_title_to = scope:new_title
		destroy_title = scope:empire
	}
	create_title_and_vassal_change = {
		type = swear_fealty
		save_scope_as = swear_fealty
		add_claim_on_loss = no
	}
	change_liege = {
		liege = scope:scoped_emperor
		change = scope:swear_fealty
	}
	hidden_effect = { primary_title = { set_de_jure_liege_title = title:e_empire_of_zul } } 
	resolve_title_and_vassal_change = scope:swear_fealty
}