namespace = wc_holy_order_decision

##################################################
# Enforce the Brotherhood
# by ElMariuso
##################################################

# Founder event
wc_holy_order_decision.0001 = {
	type = character_event
	title = wc_holy_order_decision.0001.t
	desc = wc_holy_order_decision.0001.desc
	theme = faith
	left_portrait = {
		character = scope:founder
		animation = war_defender
	}
	right_portrait = {
		character = scope:abbot
		animation = personality_zealous
	}
	lower_right_portrait = {
		character = scope:leader
	}
	
	override_background = { reference = temple_church }
	
	immediate = {
		play_music_cue = "mx_cue_crusade_starts"
		# Enforce the Brotherhood
		enforce_the_brotherhood_scripted_effect = yes
		# The Brotherhood join the war
		brotherhood_of_northshire_join_the_war_scripted_effect = yes
		
		#Notify other players.
		every_player = {
			if = {
				limit = { this = scope:abbot }
				trigger_event = wc_holy_order_decision.0002
			}
			else_if = {
				limit = {
					OR = {
						any_liege_or_above = { this = scope:founder }
						is_medivh_trigger = yes
					}
				}
				trigger_event = wc_holy_order_decision.0003
			}
			else_if = {
				limit = { 
					OR = {
						this = scope:invader
						any_liege_or_above = { this = scope:invader }
					}	
				}
				trigger_event = wc_holy_order_decision.0004
			}
			else_if = {
				limit = { character_is_realm_neighbor = title:k_stormwind.holder }
				trigger_event = wc_holy_order_decision.0005
			}
		}
	}
	
	option = {
		name = wc_holy_order_decision.0001.a
		
		add_piety = medium_piety_gain
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = wc_holy_order_decision.0001.b
		trigger = {
			has_trait = paranoid
			exists = cp:councillor_spymaster
		}
		
		stress_impact = {
			base = medium_stress_impact_gain
		}
		add_character_modifier = {
			modifier = spy_the_brotherhood_modifier
			years = 5
		}
		cp:councillor_spymaster = {
			set_council_task = {
				task_type = task_find_secrets
				target = scope:abbot
			}
		}
		
		ai_chance = {
			base = 50
		}
	}
}

# Abbot event
wc_holy_order_decision.0002 = {
	type = character_event
	title = wc_holy_order_decision.0002.t
	desc = wc_holy_order_decision.0002.desc
	theme = faith
	left_portrait = {
		character = scope:founder
		animation = stress
	}
	right_portrait = {
		character = scope:abbot
		animation = personality_zealous
	}
	lower_right_portrait = {
		character = scope:leader
	}
	
	override_background = { reference = temple_church }
	
	option = {
		name = wc_holy_order_decision.0002.a
		trigger = { NOT = { has_trait = cynical } }
		
		add_character_modifier = {
			modifier = fervor_of_the_light_modifier
			years = 5
		}
		add_piety = minor_piety_gain
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = wc_holy_order_decision.0002.b
		trigger = { 
			has_trait = cynical
			exists = cp:councillor_spymaster
		}
		
		add_character_modifier = {
			modifier = spy_the_king_modifier
			years = 5
		}
		add_piety = minor_piety_loss
		cp:councillor_spymaster = {
			set_council_task = {
				task_type = task_find_secrets
				target = scope:founder
			}
		}
		
		ai_chance = {
			base = 50
		}
	}
}

# Azeroth event
wc_holy_order_decision.0003 = {
	type = character_event
	title = wc_holy_order_decision.0003.t
	desc = wc_holy_order_decision.0003.desc
	theme = faith
	left_portrait = {
		character = scope:abbot
		animation = war_defender
	}
	right_portrait = {
		character = scope:leader
		animation = personality_zealous
	}
	lower_left_portrait = {
		character = scope:founder
	}
	
	override_background = { reference = temple_church }
	
	option = {
		name = wc_holy_order_decision.0003.a
		trigger = { NOT = { is_medivh_trigger = yes } }
		
		add_character_modifier = {
			modifier = fervor_of_the_light_modifier
			years = 5
		}
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = wc_holy_order_decision.0003.a.medivh
		trigger = { is_medivh_trigger = yes }
		
		stress_impact = {
			base = medium_stress_impact_gain
		}
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = wc_holy_order_decision.0003.b
		trigger = { NOT = { is_medivh_trigger = yes } }
		
		add_piety = medium_piety_gain
		
		ai_chance = {
			base = 50
		}
	}
}

# Invader event
wc_holy_order_decision.0004 = {
	type = character_event
	title = wc_holy_order_decision.0004.t
	desc = wc_holy_order_decision.0004.desc
	theme = faith
	left_portrait = {
		character = scope:abbot
		animation = war_defender
	}
	right_portrait = {
		character = scope:leader
		animation = personality_zealous
	}
	lower_left_portrait = {
		character = scope:founder
	}
	
	override_background = { reference = temple_church }
	
	option = {
		name = wc_holy_order_decision.0004.a
		trigger = { NOT = { root.culture = { has_cultural_pillar = heritage_orcish } } }
		
		add_character_modifier = {
			modifier = intensify_attacks_on_sanctuaries_modifier
			years = 5
		}
		
		add_prestige = medium_prestige_gain
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = wc_holy_order_decision.0004.orcs.a
		trigger = { root.culture = { has_cultural_pillar = heritage_orcish } }
		
		add_character_modifier = {
			modifier = intensify_attacks_on_sanctuaries_modifier
			years = 5
		}
		
		add_prestige = medium_prestige_gain
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = wc_holy_order_decision.0004.b
		
		add_character_modifier = {
			modifier = study_the_theology_of_the_enemy_modifier
			years = 5
		}
		
		add_piety = medium_piety_gain
		
		ai_chance = {
			base = 50
		}
	}
}

# Neighbour event
wc_holy_order_decision.0005 = {
	type = character_event
	title = wc_holy_order_decision.0005.t
	desc = wc_holy_order_decision.0005.desc
	theme = faith
	left_portrait = {
		character = scope:abbot
		animation = war_defender
	}
	right_portrait = {
		character = scope:leader
		animation = personality_zealous
	}
	lower_left_portrait = {
		character = scope:founder
	}
	
	override_background = { reference = temple_church }
	
	option = {
		name = wc_holy_order_decision.0005.holy_light.a
		trigger = { has_religion = religion:tyrism_religion }
		
		add_piety = medium_piety_gain
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = wc_holy_order_decision.0005.holy_light.b
		trigger = { has_religion = religion:tyrism_religion }
		
		add_character_modifier = {
			modifier = fervor_of_the_light_modifier
			years = 5
		}
		
		ai_chance = {
			base = 50
		}
	}
	option = {
		name = wc_holy_order_decision.0005.a
		trigger = { NOT = { has_religion = religion:tyrism_religion } }
		
		ai_chance = {
			base = 100
		}
	}
}

##################################################
# Paladins of the Silver Hand
# by Dione and ElMariuso
##################################################

# Founder event
wc_holy_order_decision.0010 = {
	type = character_event
	title = wc_holy_order_decision.0010.title
	desc = {
		first_valid = {
			triggered_desc = {
			    trigger = {
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:flag_destroyed_brotherhood
					}
			    }
			    desc = wc_holy_order_decision.0010.desc
			}
			desc = wc_holy_order_decision.0010.desc.northshire_stay
		}
	}
	theme = faith

	left_portrait = {
		character = scope:founder
		animation = personality_zealous
	}
	right_portrait = {
		character = scope:leader
		animation = personality_honorable
	}
	
	override_background = { reference = temple_church }

	immediate = {
		play_music_cue = "mx_cue_crusade_starts"
		
		# Scripted effects
		create_silver_hand_scripted_effect = yes
		manage_original_paladins_scripted_effect = yes
		create_and_distribute_original_librams_scripted_effect = yes
	}

	option = {
		name = wc_holy_order_decision.0010.a
	}
}

# Notification event
wc_holy_order_decision.0011 = {
	type = character_event
	title = wc_holy_order_decision.0011.title
	desc = {
		first_valid = {
			triggered_desc = {
			    trigger = {
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:flag_destroyed_brotherhood
					}
					any_character_artifact = {
						OR = {
							has_variable = libram_justice
							has_variable = libram_compassion
							has_variable = libram_holiness
							has_variable = libram_protection
							has_variable = libram_retribution
						}
					}
				}
				desc = wc_holy_order_decision.0011.desc.original_paladin
			}
			triggered_desc = {
				trigger = {
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:flag_destroyed_brotherhood
					}
				}
				desc = wc_holy_order_decision.0011.desc 
			}
			triggered_desc = {
				trigger = {
					any_character_artifact = {
						OR = {
							has_variable = libram_justice
							has_variable = libram_compassion
							has_variable = libram_holiness
							has_variable = libram_protection
							has_variable = libram_retribution
						}
					}
				}
				desc = wc_holy_order_decision.0011.desc.original_paladin_northshire_stay
			}
			desc = wc_holy_order_decision.0011.desc.northshire_stay
		}
	}
	theme = faith

	left_portrait = {
		character = scope:founder
		animation = personality_zealous
	}
	right_portrait = {
		character = scope:leader
		animation = personality_honorable
	}
	
	override_background = { reference = temple_church }

	immediate = { 
		play_music_cue = "mx_cue_crusade_starts"
	}

	option = {
		name = {
			trigger = { has_religion = religion:tyrism_religion }
			text = wc_holy_order_decision.0011.a
		}
		name = {
			text = wc_holy_order_decision.0011.a_other
		}
	}
}