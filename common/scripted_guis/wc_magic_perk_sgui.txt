close_scheme_reflect_interaction = {
    scope = character

    effect = {
        remove_variable = reflect_interaction
        remove_variable = reflect_interaction_cancel
        remove_variable = reflect_interaction_artifact
        remove_variable = reflect_interaction_character
        remove_variable = current_scheme
        remove_variable = landed_only
    }
}

close_give_disease_interaction = {
    scope = character

    effect = {
        if = {
            limit = {
                has_variable = give_disease_interaction
            }
            remove_variable = give_disease_interaction
            cancel_cast_effect = { SPELL = give_disease RANK = 0 TYPE = death }
            wc_change_mana_by_value_effect = {
                CHANGE = add
                VALUE = wc_spell_give_disease_cost_mana_value
            }
        }
        else_if = {
            limit = {
                has_variable = epidemic_interaction
            }
            remove_variable = epidemic_interaction
            cancel_cast_effect = { SPELL = epidemic RANK = 0 TYPE = death }
            wc_change_mana_by_value_effect = {
                CHANGE = add
                VALUE = wc_spell_epidemic_cost_mana_value
            }
            remove_character_flag = any_ritual_cd
        }
    }
}

should_close_reflect_interaction = {
    scope = character
    saved_scopes = { desc }

    is_valid = {
        NOT = {
            scope:desc = flag:wc_interaction_reflect
        }
    }
}

should_close_give_disease_interaction = {
    scope = character
    saved_scopes = { desc }

    is_valid = {
        always = yes
        NOT = {
            scope:desc = flag:wc_interaction_disease
        }
    }
}