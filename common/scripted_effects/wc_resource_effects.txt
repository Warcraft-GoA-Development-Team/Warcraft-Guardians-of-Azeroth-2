wc_change_mana_by_value_effect = {
	custom_description = { # Tooltip for changing elemental favour
		text = wc_$CHANGE$_mana_value_effect
		value = $VALUE$
		change_variable = { name = wc_current_mana_variable $CHANGE$ = $VALUE$ }
		clamp_variable = { name = wc_current_mana_variable max = wc_max_mana_value }
	}
	wc_recalculate_prowess_from_mana_effect = yes
}

wc_set_mana_to_amount_effect = {
	set_variable = { name = wc_current_mana_variable value = $AMOUNT$ }

	clamp_variable = { name = wc_current_mana_variable max = wc_max_mana_value }
	wc_recalculate_prowess_from_mana_effect = yes
}

wc_recalculate_prowess_from_mana_effect = {
	hidden_effect = {
		if = {
			limit = { # So that prowess and related things to it, like army quality, don't flick every month
				trigger_if = {
					limit = { has_variable = wc_current_mana_to_prowess_variable }
					NOT = { wc_current_mana_to_prowess_value = var:wc_current_mana_to_prowess_variable }
				}
				trigger_else = {
					always = yes
				}
			}


			if = {
				limit = { 
					wc_current_mana_to_prowess_value > 0
					NOT = { has_character_modifier = wc_prowess_from_available_mana_modifier }
				} 

				add_character_modifier = { modifier = wc_prowess_from_available_mana_modifier }
			}
			set_variable = { name = wc_current_mana_to_prowess_variable value = wc_current_mana_to_prowess_value }
		}
	}
}

wc_start_mana_regeneration_loop_effect = {
	if = {
		limit = {
			NOT = { has_variable = wc_current_mana_variable }
			# wc_mana_regeneration_value > 0
			wc_max_mana_value > 0
		}

		wc_set_mana_to_amount_effect = { AMOUNT = wc_max_mana_value }
		trigger_event = {
			on_action = wc_on_mana_regeneration
			days = { 1 28 } # So it will not cause a major lag on every 1st of each month
		}
	}
}
wc_fill_mana_on_day_one_from_perks_crutch_effect = { # Crutch for mages to have full mana on day 1
	if = {
		limit = { game_start_day_trigger = yes }

		wc_set_mana_to_amount_effect = { AMOUNT = wc_max_mana_value }
	}
}
wc_EFFECT_magical_TRAIT_effect = { # add_trait/add_trait_force_tooltip/other with wc_start_mana_regeneration_loop_effect for any trait that gives mana
	$EFFECT$ = $TRAIT$
	wc_start_mana_regeneration_loop_effect = yes # Starts mana regeneration loop
}

wc_change_hp_by_value_effect = {
	custom_description = { # Tooltip for changing elemental favour
		text = wc_$CHANGE$_hp_value_effect
		value = $VALUE$
		#health = $VALUE$
		change_variable = { name = wc_current_hp_variable $CHANGE$ = $VALUE$ }
		clamp_variable = { name = wc_current_hp_variable max = wc_hp_capacity_value }
	}
}

wc_set_hp_to_amount_effect = {
	set_variable = { name = wc_current_hp_variable value = $AMOUNT$ }
	
	clamp_variable = { name = wc_current_hp_variable max = wc_hp_capacity_value }
}

wc_start_hp_regeneration_loop_effect = {
	if = {
		limit = {
			NOT = { has_variable = wc_current_hp_variable }
		}

		wc_set_hp_to_amount_effect = { AMOUNT = wc_hp_capacity_value }
		trigger_event = {
			on_action = wc_on_health_regeneration
			days = { 1 28 } # So it will not cause a major lag on every 1st of each month
		}
	}
}