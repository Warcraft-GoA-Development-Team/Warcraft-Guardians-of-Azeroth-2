thunder_king_effect = {
	ROOT = { save_scope_as = reviver }
	
	# Set up Titles
	create_title_and_vassal_change = {
		type = returned
		save_scope_as = change
		#add_claim_on_loss = no
	}
	title:k_lei_dao = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:d_lei_shen = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:c_lei_gong = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:c_huangjia = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:c_suzao = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:c_duanzao = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:c_zhengfu_zin = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:c_zhanshi = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	title:b_shandian = {
		change_title_holder = {
			holder = scope:lei_shen
			change = scope:change
		}
	}
	#scope:reviver = {
	#	every_held_title = {
	#		limit = { 
	#			tier = tier_empire
	#		}
	#		change_title_holder = {
	#			holder = scope:lei_shen
	#			change = scope:change
	#		}
	#	}
	#	add_trait = beauty_good_1
	#}
	
	scope:reviver = {
		every_held_title = {
			if = {
				limit = {
					tier = tier_empire
				}
				change_title_holder = {
					holder = scope:lei_shen
					change = scope:change
				}
			}
			else_if = {
				limit = {
					OR = {
						NOT = { exists = scope:secondary_title }
						tier > scope:secondary_title.tier
					}
				}
				save_temporary_scope_as = secondary_title
			}
		}
	}
	
	scope:reviver = {
		if = {
			limit = {
				exists = scope:secondary_title
			}
			every_vassal = {
				limit = {
					primary_title.tier >= scope:secondary_title.tier
					NOT = {
						primary_title.tier = tier_barony
					}
				}
				change_liege = {
					liege = scope:lei_shen
					change = scope:change
				}
			}
		}
	}
	
	scope:reviver = {
		change_liege = {
			liege = scope:lei_shen
			change = scope:change
		}
	}
	# If Pandaria isn't his already, get it
	if = {
		limit = {
			NOT = { has_title = title:e_pandaria_empire }
		}
		title:e_pandaria_empire = {
			change_title_holder = {
				holder = scope:lei_shen
				change = scope:change
			}
		}
	}
	
	resolve_title_and_vassal_change = scope:change
	
	set_primary_title_to = title:e_pandaria_empire
	
	#Set max authority
	if = {
		limit = { has_realm_law_flag = uses_crown_authority }
		add_realm_law = crown_authority_3
	}
	if = {
		limit = { has_realm_law_flag = uses_tribal_authority }
		add_realm_law = tribal_authority_3
	}
	if = {
		limit = { realm_law_use_dark_frenzy_trigger = yes }
		change_dark_frenzy_effect = { VALUE = 50 }
	}
	
	#Control Counties
	every_held_county = { change_county_control = 100 }
	province:1229 = {
		set_county_culture = culture:mogu
		set_county_faith = faith:thunder_king
	}
	
	# Summon Lei Shens trusted lieutenants!
	
	# Add hooks to loyal servants
	lei_shen_add_loyalty_hook_effect = { TARGET = scope:reviver }
	scope:reviver = {
		add_opinion = {
			modifier = became_vassal
			target = scope:lei_shen
			opinion = 50
		}
	}
}


lei_shen_add_loyalty_hook_effect = {
	if = {
		limit = {
			can_add_hook = {
				target = $TARGET$
				type = loyalty_hook
			}
		}
		add_hook = {
			target = $TARGET$
			type = loyalty_hook
		}
	}
}