namespace = frozen_throne_war

#########################################
#
#	War of the Frozen Throne events - CK3 Edition
#
#########################################

# Setup the associated story
frozen_throne_war.1 = {
	scope = none
	hidden = yes

	trigger = {
		current_date >= 605.6.6
		frozen_throne_war_happened_trigger = no
	}

	immediate = {
		add_to_global_variable_list = {
			name = wc_events_happened
			target = flag:frozen_throne_war_happened
		}

		debug_log = "The War of the Frozen Throne has occured!"
		debug_log_date = yes

		title:e_illidari.holder = {
			create_story = story_frozen_throne_war
			save_scope_as = story_owner
		}
	}
}

# Starts the War of the Frozen Throne
frozen_throne_war.2 = {
	type = character_event
	title = WCHOI_2_TITLE
	desc = WCHOI_2_DESC
	theme = war
	override_background = {
		reference = wc_icecrown
	}
	left_portrait = {
		character = scope:illidan
		animation = personality_bold
	}
	right_portrait = scope:scourge_holder

	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = { # Scourge option
						trigger = { faith = faith:death_god }
						desc = frozen_throne_war.2.a
					}
					triggered_desc = { # Illidari option
						trigger = { 
							OR = {
								faith = faith:illidari
								faith = faith:cult_of_sunwell
							}
						}
						desc = frozen_throne_war.2.b
					}
					desc = frozen_throne_war.2.c # Outsider option
				}
			}
		}
	}
}

#Spawns Illidari Troops
frozen_throne_war.10 = {
	type = character_event
	hidden = yes

	immediate = {
		spawn_illidari_troops_effect = yes
		spawn_illidari_troops_effect = yes
		spawn_illidari_troops_effect = yes
		every_vassal = {
			limit = { 
				OR = {
					culture = { has_cultural_pillar = heritage_azsharic }
					culture = { has_cultural_pillar = heritage_highborne } 
				}
			}
			spawn_illidari_troops_based_on_culture_effect = yes
		}
	}
}