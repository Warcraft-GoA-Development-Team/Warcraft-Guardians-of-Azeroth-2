embrace_void_elf_culture_effect = {
	# Scopes saves for localization
	root = {
		save_scope_as = embracer
	}

	# Prestige Bonus
	add_prestige = medium_prestige_gain

	#Convert your, and your whole family's, culture
	set_culture = culture:void_elf
	if = {
		limit = { any_spouse = { is_landed = no } }
		every_spouse = {
			limit = {
				is_landed = no
				OR = {
					culture = culture:high_elf
					culture = culture:blood_elf
				}
			}
			set_culture = culture:void_elf
		}
	}
	if = {
		limit = {
			any_close_family_member = {
				is_landed = no
				NOT = { is_spouse_of = root }
			}
		}
		every_close_family_member = {
			limit = {
				is_landed = no
				NOT = { is_spouse_of = root }
			}
			custom = all_unlanded_family_members
			set_culture = culture:void_elf
		}
	}
	if = {
		limit = {
			any_child = {
				NOT = { is_spouse_of = root }
			}
		}
		every_child = {
			limit = {
				NOT = { is_spouse_of = root }
			}
			custom = all_children_custom
			set_culture = culture:void_elf
		}
	}

	#Convert appropriate vassals, and their family
	if = {
		limit = {
			any_vassal_or_below = {
				is_ai = yes
				OR = {
					culture = culture:high_elf
					culture = culture:blood_elf
				}
				has_trait=being_void
				has_trait=creature_high_elf
			}
		}
		every_vassal_or_below = {
			custom = embrace_void_elf_culture_vassals_custom
			limit = {
				is_ai = yes
				OR = {
					culture = culture:high_elf
					culture = culture:blood_elf
				}
				has_trait=being_void
				has_trait=creature_high_elf
			}
			set_culture = culture:void_elf
			hidden_effect = {
				if = {
					limit = { any_spouse = { is_landed = no } }
					every_spouse = {
						limit = {
							is_landed = no
							OR = {
								culture = culture:high_elf
								culture = culture:blood_elf
							}
							has_trait=being_void
							has_trait=creature_high_elf
						}
						set_culture = culture:void_elf
					}
				}
				if = {
					limit = {
						any_close_family_member = {
							is_landed = no
							NOT = { is_spouse_of = prev }
						}
					}
					every_close_family_member = {
						limit = {
							is_landed = no
							NOT = { is_spouse_of = prev }
						}
						custom = all_unlanded_family_members
						set_culture = culture:void_elf
					}
				}
				if = {
					limit = {
						any_child = {
							NOT = { is_spouse_of = prev }
						}
					}
					every_child = {
						limit = {
							NOT = { is_spouse_of = prev }
						}
						custom = all_children_custom
						set_culture = culture:void_elf
					}
				}
				if = {
					limit = {
						any_vassal_or_below = {
							is_ai = yes
							OR = {
								culture = culture:high_elf
								culture = culture:blood_elf
							}
							has_trait=being_void
							has_trait=creature_high_elf
						}
					}
					every_vassal_or_below = {
						custom = embrace_void_elf_culture_vassals_custom
						limit = {
							is_ai = yes
							OR = {
								culture = culture:high_elf
								culture = culture:blood_elf
							}
							has_trait=being_void
							has_trait=creature_high_elf
						}
						set_culture = culture:void_elf
						hidden_effect = {
							if = {
								limit = { any_spouse = { is_landed = no } }
								every_spouse = {
									limit = {
										is_landed = no
										OR = {
											culture = culture:high_elf
											culture = culture:blood_elf
										}
										has_trait=being_void
										has_trait=creature_high_elf
									}
									set_culture = culture:void_elf
								}
							}
							if = {
								limit = {
									any_close_family_member = {
										is_landed = no
										NOT = { is_spouse_of = prev }
									}
								}
								every_close_family_member = {
									limit = {
										is_landed = no
										NOT = { is_spouse_of = prev }
									}
									custom = all_unlanded_family_members
									set_culture = culture:void_elf
								}
							}
							if = {
								limit = {
									any_child = {
										NOT = { is_spouse_of = prev }
									}
								}
								every_child = {
									limit = {
										NOT = { is_spouse_of = prev }
									}
									custom = all_children_custom
									set_culture = culture:void_elf
								}
							}
						}
					}
				}
			}
		}
	}

	#Flip Counties
	every_county_in_region = {
		region = custom_england
		custom = embrace_void_elf_culture_counties_custom
		limit = {
			target_is_de_facto_liege_or_above = root.primary_title
		}
		random = {
			chance = 40
			set_county_culture = culture:void_elf
		}
	}

	culture:void_elf = {
		custom_tooltip = decision_embrace_void_elf_culture_get_innovations
		hidden_effect = {
			reset_culture_creation_date = yes
			get_all_innovations_from = culture:high_elf
			get_all_innovations_from = culture:blood_elf
		}
	}
}