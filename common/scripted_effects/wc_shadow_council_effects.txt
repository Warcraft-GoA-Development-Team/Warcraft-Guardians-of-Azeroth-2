##################################################
# Take over the Blackrock Mountain Effects

taking_the_blackrock_mountain_accept_effect = {
	# Mark the partition as being active.
	custom_tooltip = taking_the_blackrock_mountain_accept_effect.partition_active.tt
	set_global_variable = {
		name = partition_active_blackrock
		value = title:k_blackrock
	}
	
	# Burning steppes for Shadow-Council!
	## Scope:ntd_shadow_council_holder receives south-Shadowforge.
	scope:ntd_shadow_council_holder = {
		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
		}
		hidden_effect = {
			title:c_blackrock_spire = {
				change_title_holder = {
					holder = scope:ntd_shadow_council_holder
					change = scope:change
				}
			}
			title:d_redhelm = {
				every_in_de_jure_hierarchy = { 
					limit = {
						holder.top_liege = scope:ntd_blackrock_holder
					}
					change_title_holder = {
						holder = scope:ntd_shadow_council_holder
						change = scope:change
					}
				}
			}
			title:d_burning_steppes = {
				every_in_de_jure_hierarchy = {
					limit = {
						holder.top_liege = scope:ntd_blackrock_holder
					}
					change_title_holder = {
						holder = scope:ntd_shadow_council_holder
						change = scope:change
					}
				}
			}
			set_realm_capital = title:c_blackrock_spire
		}
		resolve_title_and_vassal_change = scope:change
	}
	## Change cultures for the Shadow Council holder culture
	scope:ntd_shadow_council_holder = {
		every_held_title = {
			limit = {
					tier = tier_county
					title_province = {
						OR = {
							geographical_region = world_eastern_kingdoms_azeroth_redridge_mountains
						}
					}
				}
			set_county_culture = culture:shadowmoon
		}
	}
	## Change religion for the Shadow Council holder religion
	scope:ntd_shadow_council_holder = {
		every_held_title = {
			limit = {
					tier = tier_county
					title_province = {
						OR = {
							geographical_region = world_eastern_kingdoms_azeroth_redridge_mountains
						}
					}
				}
			set_county_faith = faith:orcish_fel
		}
	}
	
	# Set up a ceasefire & some opinion gain between the two rulers.
	scope:ntd_blackrock_holder = {
		# For Shadow Council
		add_truce_both_ways = {
			character = scope:ntd_shadow_council_holder
			years = 25
			name = TRUCE_SIGNED_PARTITION
		}
		add_opinion = {
			target = scope:ntd_shadow_council_holder
			modifier = respect_opinion
			opinion = 50
		}
		reverse_add_opinion = {
			target = scope:ntd_shadow_council_holder
			modifier = respect_opinion
			opinion = 50
		}
		# For the Horde
		add_truce_both_ways = {
			character = scope:ntd_e_horde_holder
			years = 25
			name = TRUCE_SIGNED_PARTITION
		}
		add_opinion = {
			target = scope:ntd_e_horde_holder
			modifier = respect_opinion
			opinion = 50
		}
		reverse_add_opinion = {
			target = scope:ntd_e_horde_holder
			modifier = respect_opinion
			opinion = 50
		}
	}
}

taking_the_blackrock_mountain_reject_effect = {
	scope:ntd_shadow_council_holder = {
		# If possible, scope:ntd_shadow_council_holder & scope:ntd_blackrock_holder immediately become nemeses.
		if = {
			limit = {
				can_set_relation_nemesis_trigger = { CHARACTER = scope:ntd_blackrock_holder }
			}
			set_relation_nemesis = scope:ntd_blackrock_holder
		}
		else = {
			add_opinion = {
				target = scope:ntd_blackrock_holder
				modifier = humiliated_opinion
				opinion = -20
			}
		}
		# Scope:ntd_shadow_council_holder loses a low amount of prestige.
		add_prestige = minor_prestige_loss
	}
	scope:ntd_twilights_hammer_holder = {
		add_opinion = {
			target = scope:ntd_blackrock_holder
			modifier = humiliated_opinion
			opinion = -75
		}
		# Scope:ntd_shadow_council_holder loses a low amount of prestige.
		add_prestige = minor_prestige_loss
	}
}

taking_the_blackrock_mountain_each_way_effect = {
	random_list = {
		# The offer is accepted.
		100 = {
			show_chance = no
			desc = taking_the_blackrock_mountain_each_way_effect.accepted
			taking_the_blackrock_mountain_accept_effect = yes
		}
		# The offier is rejected.
		100 = {
			show_chance = no
			desc = taking_the_blackrock_mountain_each-way_effect.rejected
			taking_the_blackrock_mountain_reject_effect = yes
		}
	}
}

more_blackrock_mountain_accept_effect = {
	# Mark the partition as being active.
	custom_tooltip = more_blackrock_mountain_accept_effect.partition_active.tt
	set_global_variable = {
		name = partition_active_more_blackrock
		value = title:k_blackrock
	}
	
	# Badlands for Twilights Hammer!
	## Scope:ntd_twilights_hammer_holder receives Badlands.
	scope:ntd_twilights_hammer_holder = {
		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
		}
		hidden_effect = {
			title:d_badland = {
				every_in_de_jure_hierarchy = { 
					limit = {
						holder.top_liege = scope:ntd_blackrock_holder
					}
					change_title_holder = {
						holder = scope:ntd_twilights_hammer_holder
						change = scope:change
					}
				}
			}
			title:d_lethlor = {
				every_in_de_jure_hierarchy = {
					limit = {
						holder.top_liege = scope:ntd_blackrock_holder
					}
					change_title_holder = {
						holder = scope:ntd_twilights_hammer_holder
						change = scope:change
					}
				}
			}
		}
		resolve_title_and_vassal_change = scope:change
	}
	## Change cultures for the Twilights Hammer holder culture
	scope:ntd_twilights_hammer_holder = {
		every_held_title = {
			limit = {
					tier = tier_county
					title_province = {
						OR = {
							geographical_region = world_eastern_kingdoms_khaz_modan_badlands
						}
					}
				}
			set_county_culture = culture:twilights_hammer
		}
	}
	## Change religion for the Twilights Hammer holder religion
	scope:ntd_twilights_hammer_holder = {
		every_held_title = {
			limit = {
					tier = tier_county
					title_province = {
						OR = {
							geographical_region = world_eastern_kingdoms_khaz_modan_badlands
						}
					}
				}
			set_county_faith = faith:orcish_fel
		}
	}
}