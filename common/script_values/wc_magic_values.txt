### MANA

wc_sorcerer_trait_1_mana_value = 10
wc_sorcerer_trait_noninheritable_mana_value = 15
wc_sorcerer_trait_2_mana_value = 20
wc_sorcerer_trait_3_mana_value = 30

wc_base_mana_value = {
	desc = wc_mana_base_value_desc
	format = "WC_MAX_MANA_VALUE_FORMAT"

	value = 40
}

wc_base_mana_cp_terrible_value = 5
wc_base_mana_cp_poor_value = 7
wc_base_mana_cp_average_value = 10
wc_base_mana_cp_good_value = 13
wc_base_mana_cp_excellent_value = 15

wc_lifestyle_xp_gain_terrible_value = 0.03
wc_lifestyle_xp_gain_poor_value = 0.05
wc_lifestyle_xp_gain_average_value = 0.07
wc_lifestyle_xp_gain_good_value = 0.1
wc_lifestyle_xp_gain_excellent_value = 0.15

wc_mana_per_magic_perk_base_value = 2 # Also used in localization
wc_mana_per_magic_perk_magiclevel2_value = 3 # Also used in localization
wc_mana_per_magic_perk_magiclevel3_value = 4 # Also used in localization
wc_mana_per_magic_perk_magiclevel4_value = 5 # Also used in localization

wc_mana_per_light_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_light_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_light_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_light_magic_4
				has_trait = user_of_light_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_shadow_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_shadow_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_shadow_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_shadow_magic_4
				has_trait = user_of_shadow_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_disorder_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_disorder_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_disorder_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}                               
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_disorder_magic_4
				has_trait = user_of_disorder_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_order_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_order_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_order_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_order_magic_4
				has_trait = user_of_order_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_life_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_life_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_life_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_life_magic_4
				has_trait = user_of_life_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_death_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_death_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_death_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_death_magic_4
				has_trait = user_of_death_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_elemental_fire_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_elemental_fire_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_elemental_fire_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_elemental_fire_magic_4
				has_trait = user_of_elemental_fire_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_elemental_water_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_elemental_water_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_elemental_water_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_elemental_water_magic_4
				has_trait = user_of_elemental_water_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_elemental_air_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_elemental_air_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_elemental_air_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_elemental_air_magic_4
				has_trait = user_of_elemental_air_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}
wc_mana_per_elemental_earth_magic_perk_value = {
	if = {
		limit = { has_trait = user_of_elemental_earth_magic_2 }

		value = wc_mana_per_magic_perk_magiclevel2_value
	}
	else_if = {
		limit = { has_trait = user_of_elemental_earth_magic_3 }

		value = wc_mana_per_magic_perk_magiclevel3_value
	}
	else_if = {
		limit = {
			OR = {
				has_trait = user_of_elemental_earth_magic_4
				has_trait = user_of_elemental_earth_magic_5
			}
		}

		value = wc_mana_per_magic_perk_magiclevel4_value
	}
	else = { value = wc_mana_per_magic_perk_base_value }
}

wc_max_mana_value = {
	if = { # Light
		limit = { OR = {
				has_trait = wc_lifestyle_light_magic
				any_secret = { secret_type = secret_light_magic_user }
			} 
		}

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_light_magic_user } }
			}
			add = {
				desc = wc_mana_from_light_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = light_magic_lifestyle_perks
				add = light_magic_lifestyle_perk_points
				multiply = wc_mana_per_light_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = light_magic_lifestyle_perks
				add = light_magic_lifestyle_perk_points
				multiply = wc_mana_per_light_magic_perk_value
			}
		}
	}
	if = { # Shadow
		limit = { OR = {
				has_trait = wc_lifestyle_shadow_magic
				any_secret = { secret_type = secret_shadow_magic_user }
			} }

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_shadow_magic_user } }
			}
			add = {
				desc = wc_mana_from_shadow_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = shadow_magic_lifestyle_perks
				add = shadow_magic_lifestyle_perk_points
				multiply = wc_mana_per_shadow_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = shadow_magic_lifestyle_perks
				add = shadow_magic_lifestyle_perk_points
				multiply = wc_mana_per_shadow_magic_perk_value
			}
		}
	}
	if = { # Disorder
		limit = { OR = {
				has_trait = wc_lifestyle_disorder_magic
				any_secret = { secret_type = secret_disorder_magic_user }
			} }

		min = wc_base_mana_value
		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_disorder_magic_user } }
			}
			add = {
				desc = wc_mana_from_disorder_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = disorder_magic_lifestyle_perks
				add = disorder_magic_lifestyle_perk_points
				multiply = wc_mana_per_disorder_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = disorder_magic_lifestyle_perks
				add = disorder_magic_lifestyle_perk_points
				multiply = wc_mana_per_disorder_magic_perk_value
			}
		}
		
	}
	if = { # Order
		limit = { OR = {
				has_trait = wc_lifestyle_order_magic
				any_secret = { secret_type = secret_order_magic_user }
			} }

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_order_magic_user } }
			}
			add = {
				desc = wc_mana_from_order_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = order_magic_lifestyle_perks
				add = order_magic_lifestyle_perk_points
				multiply = wc_mana_per_order_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = order_magic_lifestyle_perks
				add = order_magic_lifestyle_perk_points
				multiply = wc_mana_per_order_magic_perk_value
			}
		}
			
	}
	if = { # Life
		limit = { OR = {
				has_trait = wc_lifestyle_life_magic
				any_secret = { secret_type = secret_life_magic_user }
			} }

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_life_magic_user } }
			}
			add = {
				desc = wc_mana_from_life_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = life_magic_lifestyle_perks
				add = life_magic_lifestyle_perk_points
				multiply = wc_mana_per_life_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = life_magic_lifestyle_perks
				add = life_magic_lifestyle_perk_points
				multiply = wc_mana_per_life_magic_perk_value
			}
		}
	}
	if = { # Death
		limit = { OR = {
				has_trait = wc_lifestyle_death_magic
				any_secret = { secret_type = secret_death_magic_user }
			} }

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_death_magic_user } }
			}
			add = {
				desc = wc_mana_from_death_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = death_magic_lifestyle_perks
				add = death_magic_lifestyle_perk_points
				multiply = wc_mana_per_death_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = death_magic_lifestyle_perks
				add = death_magic_lifestyle_perk_points
				multiply = wc_mana_per_death_magic_perk_value
			}
		}
	}
	# Elemental
	if = { # Fire
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_fire_magic_flag
				any_secret = { secret_type = secret_elemental_fire_magic_user }
			}			
		}

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_fire_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_fire_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_fire_magic_lifestyle_perks
				add = elemental_fire_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_fire_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_fire_magic_lifestyle_perks
				add = elemental_fire_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_fire_magic_perk_value
			}
		}
	}
	if = { # Water
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_water_magic_flag
				any_secret = { secret_type = secret_elemental_water_magic_user }
			}			
		}

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_water_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_water_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_water_magic_lifestyle_perks
				add = elemental_water_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_water_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_water_magic_lifestyle_perks
				add = elemental_water_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_water_magic_perk_value
			}
		}
	}
	if = { # Air
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_air_magic_flag
				any_secret = { secret_type = secret_elemental_air_magic_user }
			}			
		}

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_air_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_air_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_air_magic_lifestyle_perks
				add = elemental_air_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_air_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_air_magic_lifestyle_perks
				add = elemental_air_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_air_magic_perk_value
			}
		}
	}
	if = { # Earth
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_earth_magic_flag
				any_secret = { secret_type = secret_elemental_earth_magic_user }
			}			
		}

		min = wc_base_mana_value

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_earth_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_earth_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_earth_magic_lifestyle_perks
				add = elemental_earth_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_earth_magic_perk_value
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_earth_magic_lifestyle_perks
				add = elemental_earth_magic_lifestyle_perk_points
				multiply = wc_mana_per_elemental_earth_magic_perk_value
			}
		}
	}

	if = {
		limit = { has_trait = magic_good_1 }

		min = wc_base_mana_value

		add = {
			desc = wc_mana_from_magic_good_1_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_1_mana_value
		}
	}
	else_if = {
		limit = { has_trait = magic_good_2 }

		min = wc_base_mana_value

		add = {
			desc = wc_mana_from_magic_good_2_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_2_mana_value
		}
	}
	else_if = {
		limit = { has_trait = magic_good_3 }

		min = wc_base_mana_value

		add = {
			desc = wc_mana_from_magic_good_3_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_3_mana_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_1 }
		subtract = {
			desc = wc_mana_from_magic_bad_1_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_1_mana_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_2 }
		subtract = {
			desc = wc_mana_from_magic_bad_2_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_2_mana_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_3 }
		subtract = {
			desc = wc_mana_from_magic_bad_3_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_3_mana_value
		}
	}

	if = {
		limit = { has_trait = magic_good_noninheritable }
		add = {
			desc = wc_mana_from_magic_good_noninheritable_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_noninheritable_mana_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_noninheritable }
		subtract = {
			desc = wc_mana_from_magic_bad_noninheritable_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_trait_noninheritable_mana_value
		}
	}
	
	if = {
		limit = {
			exists = court_position:court_mage_court_position
		}
		
		if = {
			limit = { court_position:court_mage_court_position.aptitude:court_mage_court_position = 4 }
			add = {
				format = "WC_MAX_MANA_VALUE_FORMAT"
				desc = wc_court_mage_position_desc
				value = wc_base_mana_cp_excellent_value
			}
		}
		else_if = {
			limit = { court_position:court_mage_court_position.aptitude:court_mage_court_position = 3 }
			add = {
				format = "WC_MAX_MANA_VALUE_FORMAT"
				desc = wc_court_mage_position_desc
				value = wc_base_mana_cp_good_value
			}
		}
		else_if = {
			limit = { court_position:court_mage_court_position.aptitude:court_mage_court_position = 2 }
			add = {
				format = "WC_MAX_MANA_VALUE_FORMAT"
				desc = wc_court_mage_position_desc
				value = wc_base_mana_cp_average_value
			}
		}
		else_if = {
			limit = { court_position:court_mage_court_position.aptitude:court_mage_court_position = 1 }
			add = {
				format = "WC_MAX_MANA_VALUE_FORMAT"
				desc = wc_court_mage_position_desc
				value = wc_base_mana_cp_poor_value
			}
		}
		else_if = {
			limit = { court_position:court_mage_court_position.aptitude:court_mage_court_position = 0 }
			add = {
				format = "WC_MAX_MANA_VALUE_FORMAT"
				desc = wc_court_mage_position_desc
				value = wc_base_mana_cp_terrible_value
			}
		}
	}

	multiply = {
		value = 1

		if = {
			limit = {
				has_character_modifier = wc_conjure_drink_modifier
			}
			add = {
				desc = wc_conjure_drink_modifier
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"
				value = 0.15
			}
		}

		if = {
			limit = {
				has_character_modifier = wc_evocation_character_modifier
			}
			add = {
				desc = wc_evocation_character_modifier
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"
				value = 0.50
			}
		}

		if = {
			limit = {
				has_variable = reverse_causality_mult
			}
			add = {
				add = 0.1
				desc = reverse_causailty_value_desc
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"
				multiply = var:reverse_causality_mult
			}
		}
	}

	min = 0
	ceiling = yes
}

wc_magic_good_trait_1_mana_replenishment_value = 0.01
wc_magic_good_trait_noninheritable_mana_replenishment_value = 0.02
wc_magic_good_trait_2_mana_replenishment_value = 0.015
wc_magic_good_trait_3_mana_replenishment_value = 0.025

wc_magic_bad_trait_1_mana_regeneration_value = -0.05
wc_magic_bad_trait_noninheritable_mana_regeneration_value = -0.1
wc_magic_bad_trait_2_mana_regeneration_value = -0.15
wc_magic_bad_trait_3_mana_regeneration_value = -0.25

wc_mana_replenishment_base_value = 0.01 # Used in localization

wc_mana_replenishment_value = { # Used in localization
	value = wc_mana_replenishment_base_value
	
	if = {
		limit = { has_trait = magic_good_1 }
		add = wc_magic_good_trait_1_mana_replenishment_value
	}
	else_if = {
		limit = { has_trait = magic_good_2 }
		add = wc_magic_good_trait_2_mana_replenishment_value
	}
	else_if = {
		limit = { has_trait = magic_good_3 }
		add = wc_magic_good_trait_3_mana_replenishment_value
	}

	if = {
		limit = { has_trait = magic_good_noninheritable }
		add = wc_magic_good_trait_noninheritable_mana_replenishment_value
	}
	min = 0.01
}

wc_mana_regeneration_value = {
	add = {
		desc = wc_hp_capacity_base_desc
		format = "WC_MAX_MANA_VALUE_FORMAT"
		value = 2 
	}

	add = {
		desc = wc_mana_regeneration_from_max_value_desc
		format = "WC_MANA_REPLENISHMENT_VALUE_FORMAT"

		value = wc_max_mana_value

		multiply = {
			value = {
				add = wc_mana_replenishment_value
				multiply = 0.75
			}
		}
	}

	multiply = { # Mana Regeneration
		value = 1
		
		if = {
			limit = { has_trait = magic_bad_1 }

			add = {
				desc = wc_mana_regeneration_from_magic_bad_1_trait_value_desc
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"

				value = wc_magic_bad_trait_1_mana_regeneration_value
			}
		}
		else_if = {
			limit = { has_trait = magic_bad_2 }

			add = {
				desc = wc_mana_regeneration_from_magic_bad_2_trait_value_desc
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"

				value = wc_magic_bad_trait_2_mana_regeneration_value
			}
		}
		else_if = {
			limit = { has_trait = magic_bad_3 }

			add = {
				desc = wc_mana_regeneration_from_magic_bad_3_trait_value_desc
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"

				value = wc_magic_bad_trait_3_mana_regeneration_value
			}
		}
		if = {
			limit = { has_trait = magic_bad_noninheritable }

			add = {
				desc = wc_mana_regeneration_from_magic_bad_noninheritable_trait_value_desc
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"

				value = wc_magic_bad_trait_noninheritable_mana_regeneration_value
			}
		}
		if = {
			limit = {
				has_perk = elemental_fire_magic_tree_2_perk_5
				has_variable_list = spells_cd
				variable_list_size = { name = spells_cd value >= 3 }
			}
			add = {
				desc = wc_feedback_perk_desc
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"
				value = 0.3
			}
		}

		if = {
			limit = {
				has_character_modifier = wc_conjure_drink_modifier
			}
			add = {
				desc = wc_conjure_drink_modifier
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"
				value = 0.15
			}
		}

		if = {
			limit = {
				has_character_modifier = wc_evocation_character_modifier
			}
			add = {
				desc = wc_evocation_character_modifier
				format = "WC_MANA_REGENERATION_VALUE_PERCENTAGE_FORMAT"
				value = 0.50
			}
		}
	}

}

wc_sorcerer_trait_1_current_mana_to_prowess_value = 0.01
wc_sorcerer_trait_noninheritable_current_mana_to_prowess_value = 0.02
wc_sorcerer_trait_2_current_mana_to_prowess_value = 0.03
wc_sorcerer_trait_3_current_mana_to_prowess_value = 0.05
wc_burned_1_trait_current_mana_to_prowess_value = 0.002
wc_burned_2_trait_current_mana_to_prowess_value = 0.005
wc_burned_3_trait_current_mana_to_prowess_value = 0.008
wc_arcane_dialectics_current_mana_to_prowess_value = 0.03
wc_quickening_current_mana_to_prowess_value = 0.01

wc_current_mana_to_prowess_base_percent = 0.01 # Also used in localization

wc_current_mana_to_prowess_percent = {
	value = wc_current_mana_to_prowess_base_percent

	if = {
		limit = { has_trait = magic_good_1 }
		add = wc_sorcerer_trait_1_current_mana_to_prowess_value
	}
	else_if = {
		limit = { has_trait = magic_good_2 }
		add = wc_sorcerer_trait_2_current_mana_to_prowess_value
	}
	else_if = {
		limit = { has_trait = magic_good_3 }
		add = wc_sorcerer_trait_3_current_mana_to_prowess_value
	}
	else_if = {
		limit = { has_trait = magic_bad_1 }
		subtract = wc_sorcerer_trait_1_current_mana_to_prowess_value
	}
	else_if = {
		limit = { has_trait = magic_bad_2 }
		subtract = wc_sorcerer_trait_2_current_mana_to_prowess_value
	}
	else_if = {
		limit = { has_trait = magic_bad_3 }
		subtract = wc_sorcerer_trait_3_current_mana_to_prowess_value
	}

	if = {
		limit = { has_trait = magic_good_noninheritable }
		add = wc_sorcerer_trait_noninheritable_current_mana_to_prowess_value
	}
	else_if = {
		limit = { has_trait = magic_bad_noninheritable }
		subtract = wc_sorcerer_trait_noninheritable_current_mana_to_prowess_value
	}

	if = {
		limit = {
			has_trait = burned_1
		}
		subtract = wc_burned_1_trait_current_mana_to_prowess_value
	}
	else_if = {
		limit = {
			has_trait = burned_2
		}
		subtract = wc_burned_2_trait_current_mana_to_prowess_value
	}
	else_if = {
		limit = {
			has_trait = burned_3
		}
		subtract = wc_burned_3_trait_current_mana_to_prowess_value
	}

	if = {
		limit = {
			has_perk = order_magic_tree_1_perk_1
			wc_current_mana_percent_value >= 0.5
		}
		add = wc_arcane_dialectics_current_mana_to_prowess_value
	}

	if = {
		limit = {
			has_character_modifier = wc_quickening_modifier
			has_variable = quickening_count
		}
		add = {
			value = wc_quickening_current_mana_to_prowess_value
			multiply = var:quickening_count
		}
	}

	min = 0
}

wc_current_mana_to_prowess_value = {
	if = {
		limit = { has_variable = wc_current_mana_variable }
		add = var:wc_current_mana_variable
	}

	multiply = wc_current_mana_to_prowess_percent

	floor = yes
}

wc_current_mana_percent_value = { # Used in localization and progressbars
	if = {
		limit = { has_variable = wc_current_mana_variable }
		add = var:wc_current_mana_variable
	}
	divide = wc_max_mana_value # TODO: Divides by 0

	min = 0
}

wc_sorcerer_good_trait_1_mp_value = 4
wc_sorcerer_good_trait_2_mp_value = 7
wc_sorcerer_good_trait_3_mp_value = 10
wc_mp_special_being_value = 20
wc_mp_powerful_being_value = 10
wc_mp_special_race_value = 5

wc_mp_value = {
	if = {
		limit = { has_trait = magic_good_1 }
		add = {
			desc = wc_mana_from_magic_good_1_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_1_mp_value
		}
	}
	else_if = {
		limit = { has_trait = magic_good_2 }
		add = {
			desc = wc_mana_from_magic_good_2_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_2_mp_value
		}
	}
	else_if = {
		limit = { has_trait = magic_good_3 }
		add = {
			desc = wc_mana_from_magic_good_3_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_3_mp_value
		}
	}
	else_if = {
		limit = { has_trait = magic_good_noninheritable }
		add = {
			desc = wc_mana_from_magic_good_noninheritable_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_1_mp_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_1 }
		subtract = {
			desc = wc_mana_regeneration_from_magic_bad_1_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_1_mp_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_2 }
		subtract = {
			desc = wc_mana_regeneration_from_magic_bad_2_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_2_mp_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_3 }
		subtract = {
			desc = wc_mana_regeneration_from_magic_bad_3_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_3_mp_value
		}
	}
	else_if = {
		limit = { has_trait = magic_bad_noninheritable }
		subtract = {
			desc = wc_mana_regeneration_from_magic_bad_noninheritable_trait_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"

			value = wc_sorcerer_good_trait_1_mp_value
		}
	}
	if = { # Light
		limit = { 
			OR = {
				has_trait = wc_lifestyle_light_magic
				any_secret = { secret_type = secret_light_magic_user }
			}
		}
		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_light_magic_user } }
			}
			add = {
				desc = wc_mana_from_light_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = light_magic_lifestyle_perks
				add = light_magic_lifestyle_perk_points
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = light_magic_lifestyle_perks
				add = light_magic_lifestyle_perk_points
			}
		}
	}
	if = { # Shadow
		limit = { OR = {
				has_trait = wc_lifestyle_shadow_magic
				any_secret = { secret_type = secret_shadow_magic_user }
			} }

			if = {
				limit = {
					NOT = { any_secret = { secret_type = secret_shadow_magic_user } }
				}
				add = {
					desc = wc_mana_from_shadow_perks_value_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = shadow_magic_lifestyle_perks
					add = shadow_magic_lifestyle_perk_points
				}
			}
			else = {
				add = {
					desc = wc_source_unknown_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = shadow_magic_lifestyle_perks
					add = shadow_magic_lifestyle_perk_points
				}
			}
	}
	if = { # Disorder
		limit = { OR = {
				has_trait = wc_lifestyle_disorder_magic
				any_secret = { secret_type = secret_disorder_magic_user }
			} }

			if = {
				limit = {
					NOT = { any_secret = { secret_type = secret_disorder_magic_user } }
				}
				add = {
					desc = wc_mana_from_disorder_perks_value_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = disorder_magic_lifestyle_perks
					add = disorder_magic_lifestyle_perk_points
				}
			}
			else = {
				add = {
					desc = wc_source_unknown_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = disorder_magic_lifestyle_perks
					add = disorder_magic_lifestyle_perk_points
				}
			}
	}
	if = { # Order
		limit = { OR = {
				has_trait = wc_lifestyle_order_magic
				any_secret = { secret_type = secret_order_magic_user }
			} }

			if = {
				limit = {
					NOT = { any_secret = { secret_type = secret_order_magic_user } }
				}
				add = {
					desc = wc_mana_from_order_perks_value_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = order_magic_lifestyle_perks
					add = order_magic_lifestyle_perk_points
				}
			}
			else = {
				add = {
					desc = wc_source_unknown_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = order_magic_lifestyle_perks
					add = order_magic_lifestyle_perk_points
				}
			}
	}
	if = { # Life
		limit = { OR = {
				has_trait = wc_lifestyle_life_magic
				any_secret = { secret_type = secret_life_magic_user }
			} }

			if = {
				limit = {
					NOT = { any_secret = { secret_type = secret_life_magic_user } }
				}
				add = {
					desc = wc_mana_from_life_perks_value_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = life_magic_lifestyle_perks
					add = life_magic_lifestyle_perk_points
				}
			}
			else = {
				add = {
					desc = wc_source_unknown_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = life_magic_lifestyle_perks
					add = life_magic_lifestyle_perk_points
				}
			}
	}
	if = { # Death
		limit = { OR = {
				has_trait = wc_lifestyle_death_magic
				any_secret = { secret_type = secret_death_magic_user }
			} }

			if = {
				limit = {
					NOT = { any_secret = { secret_type = secret_death_magic_user } }
				}
				add = {
					desc = wc_mana_from_death_perks_value_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = death_magic_lifestyle_perks
					add = death_magic_lifestyle_perk_points
				}
			}
			else = {
				add = {
					desc = wc_source_unknown_desc
	
					format = "WC_MAX_MANA_VALUE_FORMAT"
		
					value = death_magic_lifestyle_perks
					add = death_magic_lifestyle_perk_points
				}
			}
	}
	# Elemental
	if = { # Fire
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_fire_magic_flag
				any_secret = { secret_type = secret_elemental_fire_magic_user }
			}			
		}

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_fire_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_fire_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_fire_magic_lifestyle_perks
				add = elemental_fire_magic_lifestyle_perk_points
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_fire_magic_lifestyle_perks
				add = elemental_fire_magic_lifestyle_perk_points
			}
		}
	}
	if = { # Water
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_water_magic_flag
				any_secret = { secret_type = secret_elemental_water_magic_user }
			}			
		}

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_water_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_water_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_water_magic_lifestyle_perks
				add = elemental_water_magic_lifestyle_perk_points
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_water_magic_lifestyle_perks
				add = elemental_water_magic_lifestyle_perk_points
			}
		}
	}
	if = { # Air
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_air_magic_flag
				any_secret = { secret_type = secret_elemental_air_magic_user }
			}			
		}

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_air_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_air_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_air_magic_lifestyle_perks
				add = elemental_air_magic_lifestyle_perk_points
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_air_magic_lifestyle_perks
				add = elemental_air_magic_lifestyle_perk_points
			}
		}
	}
	if = { # Earth
		limit = {
			OR = {
				has_trait_with_flag = wc_lifestyle_elemental_earth_magic_flag
				any_secret = { secret_type = secret_elemental_earth_magic_user }
			}			
		}

		if = {
			limit = {
				NOT = { any_secret = { secret_type = secret_elemental_earth_magic_user } }
			}
			add = {
				desc = wc_mana_from_elemental_earth_perks_value_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_earth_magic_lifestyle_perks
				add = elemental_earth_magic_lifestyle_perk_points
			}
		}
		else = {
			add = {
				desc = wc_source_unknown_desc

				format = "WC_MAX_MANA_VALUE_FORMAT"
	
				value = elemental_earth_magic_lifestyle_perks
				add = elemental_earth_magic_lifestyle_perk_points
			}
		}
	}

	if = {
		limit = {
			has_trait = aspect_of_nature
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_aspect_of_nature
			value = wc_mp_powerful_being_value			
		}
	}
	else_if = {
		limit = {
			has_trait = aspect_of_earth
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_aspect_of_earth
			value = wc_mp_powerful_being_value			
		}
	}
	else_if = {
		limit = {
			has_trait = aspect_of_magic
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_aspect_of_magic
			value = wc_mp_powerful_being_value			
		}
	}
	else_if = {
		limit = {
			has_trait = aspect_of_time
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_aspect_of_time
			value = wc_mp_powerful_being_value			
		}
	}
	else_if = {
		limit = {
			has_trait = aspect_of_infinity
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_aspect_of_infinity
			value = wc_mp_powerful_being_value			
		}
	}
	else_if = {
		limit = {
			has_trait = aspect_of_death
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_aspect_of_death
			value = wc_mp_powerful_being_value			
		}
	}
	if = {
		limit = {
			has_trait = being_undead
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_being_undead
			value = wc_mp_special_race_value		
		}
	}
	if = {
		limit = {
			has_trait = being_demon
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_being_demon
			value = wc_mp_special_race_value		
		}
	}
	if = {
		limit = {
			has_trait = being_void
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_being_void
			value = wc_mp_special_race_value		
		}
	}
	if = {
		limit = {
			has_trait = being_life
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_being_life
			value = wc_mp_special_race_value		
		}
	}
	if = {
		limit = {
			has_trait = being_order
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_being_order
			value = wc_mp_special_race_value		
		}
	}
	if = {
		limit = {
			has_trait = being_light
		}
		add = {
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = trait_being_light
			value = wc_mp_special_race_value		
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_burnout_modifier
			has_variable = burnout_count
		}
		add = {
			value = var:burnout_count
			multiply = -5
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = wc_burnout_modifier
		}
	}
	else_if = {
		limit = {
			has_character_modifier = wc_burnout_good_modifier
			has_variable = burnout_count
		}
		add = {
			value = var:burnout_count
			multiply = 5
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = wc_burnout_good_modifier
		}
	}
	if = {
		limit = {
			has_variable = mp_add
		}
		add = {
			value = var:mp_add
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = wc_misc
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_sacrifice_modifier
		}
		subtract = {
			value = 5
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = wc_elemental_sacrifice_modifier
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_fire_decay_ritual_feed_modifier
		}
		subtract = {
			value = 10
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = wc_fire_decay_ritual_feed_modifier
		}
	}
	floor = yes
	min = 0
}

wc_mp_duration_value_percentage = {
	add = wc_mp_value 
	multiply = 4 
	divide = 1000 
}

wc_mp_value_cd_percentage = {
	add = wc_mp_value 
	multiply = 2.5 
	divide = 1000
}

# Magic Resistance
wc_magic_resistance_base_value = 6
wc_magic_resistance_racial_value = 5
wc_magic_vulnerability_racial_value = -5
wc_magic_resistance_religion_criminal_value = -3
wc_magic_resistance_religion_shunned_value = -2
wc_magic_resistance_religion_accepted_value = 2
wc_magic_resistance_religion_idolised_value = 3
wc_magic_resistance_level2_value = 2
wc_magic_resistance_level3_value = 4
wc_magic_resistance_level4_value = 6
wc_magic_resistance_level5_value = 8

wc_light_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_shadow_magic_2 }


		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_shadow_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_shadow_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_shadow_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = {
		limit = {
			faith = { has_doctrine = doctrine_shadow_magic_approved }
		}
		add = {
			value = wc_magic_resistance_religion_idolised_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_shadow_magic_accepted }
		}
		add = {
			value = wc_magic_resistance_religion_accepted_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_shadow_magic_ignored }
		}
		add = {
			value = wc_magic_resistance_religion_shunned_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_shadow_magic_crime }
		}
		add = {
			value = wc_magic_resistance_religion_criminal_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_light_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_light_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_order_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}

	# From User traits
	if = { 
		limit = { has_trait = user_of_disorder_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_disorder_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_disorder_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_disorder_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = {
		limit = {
			faith = { has_doctrine = doctrine_disorder_magic_approved }
		}
		add = {
			value = wc_magic_resistance_religion_idolised_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_disorder_magic_accepted }
		}
		add = {
			value = wc_magic_resistance_religion_accepted_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_disorder_magic_ignored }
		}
		add = {
			value = wc_magic_resistance_religion_shunned_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_disorder_magic_crime }
		}
		add = {
			value = wc_magic_resistance_religion_criminal_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_order_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_order_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_death_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_life_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_life_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_life_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_life_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = {
		limit = {
			faith = { has_doctrine = doctrine_life_magic_approved }
		}
		add = {
			value = wc_magic_resistance_religion_idolised_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_life_magic_accepted }
		}
		add = {
			value = wc_magic_resistance_religion_accepted_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_life_magic_ignored }
		}
		add = {
			value = wc_magic_resistance_religion_shunned_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_life_magic_crime }
		}
		add = {
			value = wc_magic_resistance_religion_criminal_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_death_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_death_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_disorder_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_order_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_order_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_order_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_order_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = {
		limit = {
			faith = { has_doctrine = doctrine_order_magic_approved }
		}
		add = {
			value = wc_magic_resistance_religion_idolised_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_order_magic_accepted }
		}
		add = {
			value = wc_magic_resistance_religion_accepted_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_order_magic_ignored }
		}
		add = {
			value = wc_magic_resistance_religion_shunned_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_order_magic_crime }
		}
		add = {
			value = wc_magic_resistance_religion_criminal_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_disorder_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_disorder_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_life_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = { # Can be added or removed dynamically
		limit = { has_variable = wc_life_magic_resistance }
		add = var:wc_life_magic_resistance
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_death_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_death_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_death_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_death_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = {
		limit = {
			faith = { has_doctrine = doctrine_death_magic_approved }
		}
		add = {
			value = wc_magic_resistance_religion_idolised_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_death_magic_accepted }
		}
		add = {
			value = wc_magic_resistance_religion_accepted_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_death_magic_ignored }
		}
		add = {
			value = wc_magic_resistance_religion_shunned_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_death_magic_crime }
		}
		add = {
			value = wc_magic_resistance_religion_criminal_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_life_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_life_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_shadow_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_light_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_light_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_light_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_light_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = {
		limit = {
			faith = { has_doctrine = doctrine_light_magic_approved }
		}
		add = {
			value = wc_magic_resistance_religion_idolised_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_light_magic_accepted }
		}
		add = {
			value = wc_magic_resistance_religion_accepted_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_light_magic_ignored }
		}
		add = {
			value = wc_magic_resistance_religion_shunned_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_light_magic_crime }
		}
		add = {
			value = wc_magic_resistance_religion_criminal_value
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_shadow_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_shadow_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_elemental_fire_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = { # Can be added or removed dynamically
		limit = { has_variable = wc_elemental_fire_magic_resistance }
		add = var:wc_elemental_fire_magic_resistance
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_elemental_water_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_water_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_water_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_water_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = { # Spirit Magic means more MR
		limit = {
			faith = { has_doctrine = doctrine_elemental_fire_spirit_magic_approved }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_idolised_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_elemental_fire_spirit_magic_accepted }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_accepted_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_fire_spirit_magic_ignored }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_shunned_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_fire_spirit_magic_illegal }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_criminal_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_fire_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_fire_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# Spells
	if = {
		limit = {
			has_character_modifier = wc_summon_fire_elemental_modifier
		}
		add = {
			value = 5
			desc = wc_summon_fire_elemental_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait = burned_1
		}
		add = {
			value = -3
			desc = trait_burned_1
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait = burned_2
		}
		add = {
			value = -5
			desc = trait_burned_2
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait = burned_3
		}
		add = {
			value = -8
			desc = trait_burned_3
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_elemental_air_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = { # Can be added or removed dynamically
		limit = { has_variable = wc_elemental_air_magic_resistance }
		add = var:wc_elemental_air_magic_resistance
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_elemental_earth_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_earth_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_earth_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_earth_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith

	if = { # Spirit Magic means more MR
		limit = {
			faith = { has_doctrine = doctrine_elemental_earth_spirit_magic_approved }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_idolised_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_elemental_earth_spirit_magic_accepted }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_accepted_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_earth_spirit_magic_ignored }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_shunned_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_earth_spirit_magic_illegal }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_criminal_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_air_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_air_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_elemental_water_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = { # Can be added or removed dynamically
		limit = { has_variable = wc_elemental_water_magic_resistance }
		add = var:wc_elemental_water_magic_resistance
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_elemental_fire_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_fire_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_fire_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_fire_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = { # Spirit Magic means more MR
		limit = {
			faith = { has_doctrine = doctrine_elemental_water_spirit_magic_approved }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_idolised_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_elemental_water_spirit_magic_accepted }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_accepted_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_water_spirit_magic_ignored }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_shunned_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_water_spirit_magic_illegal }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_criminal_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_water_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_water_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_summon_fire_elemental_modifier
		}
		add = {
			value = 5
			desc = wc_summon_fire_elemental_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait = frostbite_1
		}
		add = {
			value = -3
			desc = trait_frostbite_1
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait = frostbite_2
		}
		add = {
			value = -5
			desc = trait_frostbite_2
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait = frostbite_3
		}
		add = {
			value = -8
			desc = trait_frostbite_3
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_elemental_earth_magic_resistance_value = {
	max = 20
	min = -5
	value = {
		add = {
			value = wc_magic_resistance_base_value
			desc = wc_mana_base_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# From User traits
	if = { 
		limit = { has_trait = user_of_elemental_air_magic_2 }

		add = {
			value = wc_magic_resistance_level2_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_air_magic_3 }

		add = {
			value = wc_magic_resistance_level3_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_air_magic_4 }

		add = {
			value = wc_magic_resistance_level4_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = { has_trait = user_of_elemental_air_magic_5 }

		add = {
			value = wc_magic_resistance_level5_value
			desc = wc_magic_scaling_value_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Faith
	if = { # Spirit Magic means more MR
		limit = {
			faith = { has_doctrine = doctrine_elemental_air_spirit_magic_approved }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_idolised_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine = doctrine_elemental_air_spirit_magic_accepted }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_accepted_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_air_spirit_magic_ignored }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_shunned_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	else_if = {
		limit = {
			faith = { has_doctrine_parameter = elemental_air_spirit_magic_illegal }
		}
		add = {
			value = {
				add = wc_magic_resistance_religion_criminal_value
			}
			desc = wc_magic_religion_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	# By Race
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_earth_magic_resistance
		}
		add = {
			value = wc_magic_resistance_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_trait_with_flag = racial_elemental_earth_magic_vulnerability
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_race_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			is_lowborn = yes
		}
		add = {
			value = wc_magic_vulnerability_racial_value
			desc = wc_magic_lowborn_desc
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_minor_protection_modifier
		}
		add = {
			value = 3
			desc = wc_elemental_fire_minor_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
	if = {
		limit = {
			has_character_modifier = wc_elemental_fire_major_protection_modifier
		}
		add = {
			value = 6
			desc = wc_elemental_fire_major_protection_modifier
			format = "WC_MAX_MANA_VALUE_FORMAT"
		}
	}
}
wc_elemental_fire_magic_resistance_dodge_liege_value = {
	add = wc_elemental_fire_magic_resistance_value
	add = liege.wc_elemental_fire_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_elemental_fire_magic_resistance_dodge_value = {
	add = wc_elemental_fire_magic_resistance_value
	multiply = 3.5
}
wc_elemental_earth_magic_resistance_dodge_liege_value = {
	add = wc_elemental_earth_magic_resistance_value
	add = liege.wc_elemental_earth_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_elemental_earth_magic_resistance_dodge_value = {
	add = wc_elemental_earth_magic_resistance_value
	multiply = 3.5
}
wc_elemental_air_magic_resistance_dodge_liege_value = {
	add = wc_elemental_air_magic_resistance_value
	add = liege.wc_elemental_air_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_elemental_air_magic_resistance_dodge_value = {
	add = wc_elemental_air_magic_resistance_value
	multiply = 3.5
}
wc_elemental_water_magic_resistance_dodge_liege_value = {
	add = wc_elemental_water_magic_resistance_value
	add = liege.wc_elemental_water_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_elemental_water_magic_resistance_dodge_value = {
	add = wc_elemental_water_magic_resistance_value
	multiply = 3.5
}
wc_light_magic_resistance_dodge_liege_value = {
	add = wc_light_magic_resistance_value
	add = liege.wc_light_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_light_magic_resistance_dodge_value = {
	add = wc_light_magic_resistance_value
	multiply = 3.5
}
wc_shadow_magic_resistance_dodge_liege_value = {
	add = wc_shadow_magic_resistance_value
	add = liege.wc_shadow_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_shadow_magic_resistance_dodge_value = {
	add = wc_shadow_magic_resistance_value
	multiply = 3.5
}
wc_death_magic_resistance_dodge_liege_value = {
	add = wc_death_magic_resistance_value
	add = liege.wc_death_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_death_magic_resistance_dodge_value = {
	add = wc_death_magic_resistance_value
	multiply = 3.5
}
wc_life_magic_resistance_dodge_liege_value = {
	add = wc_life_magic_resistance_value
	add = liege.wc_life_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_life_magic_resistance_dodge_value = {
	add = wc_life_magic_resistance_value
	multiply = 3.5
}
wc_order_magic_resistance_dodge_liege_value = {
	add = wc_order_magic_resistance_value
	add = liege.wc_order_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_order_magic_resistance_dodge_value = {
	add = wc_order_magic_resistance_value
	multiply = 3.5
}
wc_disorder_magic_resistance_dodge_liege_value = {
	add = wc_disorder_magic_resistance_value
	add = liege.wc_disorder_magic_resistance_value
	divide = 2
	multiply = 3.5
}
wc_disorder_magic_resistance_dodge_value = {
	add = wc_disorder_magic_resistance_value
	multiply = 3.5
}
wc_hp_capacity_value = {
	value = 0
	add = {
		value = health
	}
	multiply = 10
}

wc_current_hp_percent_value = { # Used in localization and progressbars
	if = {
		limit = { has_variable = wc_current_hp_variable }
		add = var:wc_current_hp_variable
	}
	divide = wc_hp_capacity_value

	min = 0
}

wc_hp_replenishment_base_value = 2 # per month

wc_hp_replenishment_value = {
	add = {
		value = wc_hp_replenishment_base_value
		format = "WC_MAX_MANA_VALUE_FORMAT"
		desc = wc_hp_capacity_base_desc
	}
	if = {
		limit = {
			wc_hp_capacity_value > 100
		}
		add = {
			value = {
				add = wc_hp_capacity_value
				subtract = 100 
				divide = 2
			} 
			format = "WC_MAX_MANA_VALUE_FORMAT"
			desc = wc_hp_capacity_desc
		}
	}
	#add diseases here
	#add custom spells here
	# if = {
	# 	limit = {
	# 		has_variable = wc_hp_regen_boost_value
	# 	}
	# 	add = {
	# 		value = var:wc_hp_regen_boost_value
	# 		format = "WC_MAX_MANA_VALUE_FORMAT"
	# 		desc = wc_from_spells_desc
	# 	}
	# }
}


# Magic Gender Chance

light_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = light_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = light_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines
	if = {
		limit = { 
			faith = { has_doctrine_parameter = elunic_light_magic_female_only } 
		}
		if = { 
			limit = { is_female = yes }
			value = 1
		} else = { 
			value = 0
		}
	}
	if = { 
		limit = { 
			OR = { 
				faith = { has_doctrine_parameter = troll_faith_magic_gender } 
				faith = { has_doctrine_parameter = eks_faith_magic_gender }
			}
		}
		value = root_faith_dominant_gender_clergy_female_chance
	}

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

shadow_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = shadow_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = shadow_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines
	if = { 
		limit = { faith = { has_doctrine_parameter = troll_faith_magic_gender } }
		value = root_faith_dominant_gender_clergy_female_chance
	}

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

order_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = order_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = order_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

disorder_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = disorder_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = disorder_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

life_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = life_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = life_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines
	if = {
		limit = { 
			faith = { has_doctrine_parameter = elunic_life_magic_male_only } 
		}
		if = { 
			limit = { is_female = no }
			value = 1
		} else = { 
			value = 0
		}
	}

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

death_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = death_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = death_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

elemental_fire_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_fire_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_fire_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

elemental_water_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_water_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_water_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

elemental_air_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_air_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_air_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}

elemental_earth_magic_user_gender_chance = {

	#-- general doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_earth_magic_gender_dominant } }
		value = root_faith_dominant_gender_female_chance
	}
	if = { 
		limit = { faith = {  has_doctrine_parameter = elemental_earth_magic_gender_clerical } }
		value = root_faith_clergy_gender_female_chance
	}
	
	#-- special doctrines
	if = { 
		limit = { faith = {  has_doctrine_parameter = earthmother_magic_gender } }
		value = root_faith_clergy_gender_female_chance
	}

	#-- ubiquitous - always should be last
	if = { 
		limit = { faith = { has_doctrine_parameter = magic_use_ubiquitous } }
		value = 0.5
	}
}
