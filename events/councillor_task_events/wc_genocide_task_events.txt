namespace = genocide_task

genocide_task.0001 = {
    type = character_event
    title = genocide_task.0001.t
    desc = genocide_task.0001.desc
    theme = death
    left_portrait = {
        character = scope:councillor_liege
        animation = personality_callous
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_corruption_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial < high_skill_rating
        }
        scope:county = {
            any_neighboring_county = {
                holder.top_liege = scope:county.holder.top_liege
            }
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = -0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }

        scope:county = {
            every_neighboring_county = {
                limit = {
                    this.holder.top_liege = scope:county.holder.top_liege
                }

                add_county_modifier = {
                    modifier = corruption_disease_modifier
                    days = 100
                }
            }
        }
    }

    option = {
        name = genocide_task.0001.a

        stress_impact = {
            zealous = major_dread_loss
            sadistic = major_dread_loss
            arbitrary = major_dread_loss
            callous = major_dread_loss

            forgiving = major_stress_impact_gain
            just = major_stress_impact_gain
            generous = major_stress_impact_gain
            compassionate = major_stress_impact_gain
        }

        ai_chance = {
            base = 50
        }
    }
}

genocide_task.0002 = {
    type = character_event
    title = genocide_task.0002.t
    desc = genocide_task.0002.desc
    theme = martial
    override_background = { reference = burning_building }
    left_portrait = {
        character = scope:councillor
        animation = worry
    }

    right_portrait = {
        character = scope:councillor_liege
        animation = personality_rational
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_corruption_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial <= high_skill_rating
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = -0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }

        stress_impact = {
            paranoid = minor_stress_impact_gain
        }

        scope:county = {
            add_county_modifier = {
                modifier = genocide_marauding_forces_modifier
                days = 100
            }

            every_neighboring_county = {
                add_county_modifier = {
                    modifier = genocide_marauding_forces_modifier
                    days = 100
                }
            }

            culture = {
                if = {
                    limit = {
                        NOT = {
                            this = scope:councillor_liege.culture
                        }
                    }
                    change_cultural_acceptance = {
                        target = scope:councillor_liege.culture
                        value = -5
                        desc = genocide_task.0002.acceptance
                    }
                }
            }
        }
    }

    option = {
        name = genocide_task.0002.a

        add_dread = 25
        add_gold = 25

        stress_impact = {
            forgiving = 25
            just = 25
            generous = 25
            compassionate = 25
            sadistic = -25
            arbitrary = -25
            callous = -25
            wrathful = -25
            vengeful = -25
        }

        scope:county = {

            remove_county_modifier = genocide_marauding_forces_modifier
            add_county_modifier = {
                modifier = genocide_purged_marauders_modifier
                days = 100
            }

            every_neighboring_county = {
                remove_county_modifier = genocide_marauding_forces_modifier
                add_county_modifier = {
                    modifier = genocide_purged_marauders_modifier
                    days = 100
                }
            }
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_compassion = -1.0
            }
        }
    }

    option = {
        name = genocide_task.0002.b

        add_dread = -25

        stress_impact = {
            paranoid = minor_stress_impact_gain
            ambitious = minor_stress_impact_gain
            wrathful = minor_stress_impact_gain
            vengeful = minor_stress_impact_gain
        }

        ai_chance = {
            base = 25

            ai_value_modifier = {
                ai_compassion = 1.0
            }
        }
    }
}

genocide_task.0101 = {
    type = character_event
    title = genocide_task.0101.t
    desc = genocide_task.0101.desc
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = anger
    }

    lower_left_portrait = {
        character = scope:councillor
    }

    right_portrait = {
        character = scope:champion
        animation = aggressive_spear
    }

    immediate = {
        hidden_effect = {
            scope:champion = {
                if = {
                    limit = {
                        has_being_trait_trigger = no
                    }

                    genocide_add_champion_being_trait_effect = yes
                }
            }
        }
    }

    option = {
        name = genocide_task.0101.a
        duel = {
            skill = prowess
            target = scope:champion
            50 = {
                compare_modifier = {
                    value = scope:duel_value
                    multiplier = 3.5
                    min = -49
                }
                send_interface_toast = {
                    add_prestige = minor_prestige_gain
                    scope:champion = {
                        override_death_killer_effect = { death_reason = death_duel killer = scope:councillor_liege }
                    }
                    title = travel_events.2200.b.success
                    left_icon = scope:champion
                }
            }
            50 = {
                compare_modifier = {
                    value = scope:duel_value
                    multiplier = -3.5
                    min = -49
                }
                add_prestige = medium_prestige_loss
                random_list = {
                    80 = {
                        root= {
                            send_interface_toast = {
                                every_courtier_or_guest = {
                                    custom = 6140_every_courtier_or_guest
                                    add_opinion = {
                                        target = root
                                        modifier = respect_opinion
                                        opinion = -20
                                    }
                                }


                                title = travel_events.2200.b.failure
                                left_icon = scope:champion
                            }
                        }
                    }
                    20 = {
                        root = {
                            send_interface_toast = {
                                title = travel_events.2200.b.failure
                                left_icon = scope:champion
                                increase_wounds_no_death_effect = { REASON = fight }
                            }
                        }
                    }
                }
            }
        }

        stress_impact = {
            brave = minor_stress_impact_loss
            wrathful = medium_stress_impact_loss
            craven = medium_stress_impact_gain
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_boldness = 1.0
            }
        }
    }

    option = {
        name = genocide_task.0101.b
        scope:councillor = {
            duel = {
                skill = prowess
                target = scope:champion
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = 3.5
                        min = -49
                    }
                    send_interface_toast = {
                        add_prestige = minor_prestige_gain
                        scope:champion = {
                            override_death_killer_effect = { death_reason = death_duel killer = scope:councillor }
                        }
                        title = travel_events.2200.b.success
                        left_icon = scope:champion
                    }
                }
                50 = {
                    compare_modifier = {
                        value = scope:duel_value
                        multiplier = -3.5
                        min = -49
                    }
                    add_prestige = medium_prestige_loss
                    random_list = {
                        80 = {
                            root= {
                                send_interface_toast = {
                                    every_courtier_or_guest = {
                                        custom = 6140_every_courtier_or_guest
                                        add_opinion = {
                                            target = root
                                            modifier = respect_opinion
                                            opinion = -20
                                        }
                                    }


                                    title = travel_events.2200.b.failure
                                    left_icon = scope:champion
                                }
                            }
                        }
                        20 = {
                            root = {
                                send_interface_toast = {
                                    title = travel_events.2200.b.failure
                                    left_icon = scope:champion
                                    increase_wounds_no_death_effect = { REASON = fight }
                                }
                            }
                        }
                    }
                }
            }
        }

        stress_impact = {
            brave = minor_stress_impact_gain
            wrathful = medium_stress_impact_gain
            craven = medium_stress_impact_loss
        }

        ai_chance = {
            base = 20

            ai_value_modifier = {
                ai_boldness = -1.0
            }
        }
    }
}

genocide_task.0111 = {
    type = character_event
    hidden = yes

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_cleansing_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial < high_skill_rating
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = -0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }

        if = {
            limit = {
                scope:county = {
                    OR = {
                        has_county_modifier = county_corruption_light_modifier
                        has_county_modifier = county_corruption_arcane_modifier
                        has_county_modifier = county_corruption_life_modifier
                    }
                }
            }
            genocide_spawn_champion_effect = { CULTURE = scope:county.culture FAITH = scope:county.faith GOOD = yes }
        }
        else = {
            genocide_spawn_champion_effect = { CULTURE = scope:county.culture FAITH = scope:county.faith GOOD = no }
        }

        trigger_event = genocide_task.0101
    }
}

genocide_task.0102 = {
    type = character_event
    title = genocide_task.0102.t
    desc = genocide_task.0102.desc
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = personality_zealous
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_cleansing_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial < high_skill_rating
        }
        OR = {
            AND = {
                OR = {
                    OR = {
                        has_trait = magic_good
                        has_trait = magic_good_noninheritable
                    }
                    scope:councillor = {
                        OR = {
                            has_trait = magic_good
                            has_trait = magic_good_noninheritable
                        }
                    }
                }
                scope:county = {
                    any_neighboring_county = {
                        has_corruption_modifier_trigger = yes
                        has_beneficial_corruption_this_province_trigger = no
                    }
                }
            }
            scope:county = {
                any_neighboring_county = {
                    any_neighboring_county = {
                        has_corruption_modifier_trigger = yes
                        has_beneficial_corruption_this_province_trigger = no
                    }
                }
            }
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = -0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }
    }

    option = {
        name = genocide_task.0302.a

        trigger = {
            exists = capital_county
            OR = {
                OR = {
                    has_trait = magic_good
                    has_trait = magic_good_noninheritable
                }
                scope:councillor = {
                    OR = {
                        has_trait = magic_good
                        has_trait = magic_good_noninheritable
                    }
                }
            }
            scope:county = {
                any_neighboring_county = {
                    has_corruption_modifier_trigger = yes
                    has_beneficial_corruption_this_province_trigger = no
                }
            }
        }

        add_piety = -100

        scope:county = {
            add_county_modifier = genocide_controlled_energy_modifier
            every_neighboring_county = {
                limit = {
                    has_corruption_modifier_trigger = yes
                    has_beneficial_corruption_this_province_trigger = no
                }

                add_county_modifier = genocide_controlled_energy_modifier
            }
        }

        ai_chance = {
            base = 99
        }

        stress_impact = {
            compassionate = minor_stress_impact_loss
            arrogant = minor_stress_impact_gain
            sadistic = medium_stress_impact_gain
        }
    }

    option = {
        name = genocide_task.0302.b

        trigger = {
            scope:county = {
                any_neighboring_county = {
                    any_neighboring_county = {
                        has_corruption_modifier_trigger = yes
                        has_beneficial_corruption_this_province_trigger = no
                    }
                }
            }
        }

        add_prestige = -100

        scope:county = {
            every_neighboring_county = {
                save_temporary_scope_as = temp_county
                if = {
                    limit = {
                        has_corruption_modifier_trigger = yes
                        has_beneficial_corruption_this_province_trigger = no
                    }

                    add_to_list = counties
                }
                every_neighboring_county = {
                    limit = {
                        NOT = {
                            this = scope:county
                        }
                        has_corruption_modifier_trigger = yes
                        has_beneficial_corruption_this_province_trigger = no
                    }

                    add_to_list = counties
                }
            }
        }

        every_in_list = {
            list = counties

            add_county_modifier = {
                modifier = genocide_wild_energy_modifier
                days = 100
            }
        }

        stress_impact = {
            compassionate = minor_stress_impact_gain
            arrogant = minor_stress_impact_loss
            sadistic = medium_stress_impact_loss
        }

        ai_chance = {
            base = 1
        }
    }
}

genocide_task.0201 = { # Re-flavored version of genocide_task.0001 for purge instead of corrupt
    type = character_event
    title = genocide_task.0201.t
    desc = genocide_task.0201.desc
    theme = death
    left_portrait = {
        character = scope:councillor_liege
        animation = personality_callous
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_genocide_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial < high_skill_rating
        }
        scope:county = {
            any_neighboring_county = {
                holder.top_liege = scope:county.holder.top_liege
            }
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = -0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }

        scope:county = {
            every_neighboring_county = {
                limit = {
                    this.holder.top_liege = scope:county.holder.top_liege
                }

                add_county_modifier = {
                    modifier = genocidal_unrest_modifier
                    days = 100
                }
            }
        }
    }

    option = {
        name = genocide_task.0201.a

        stress_impact = {
            zealous = major_stress_impact_loss
            sadistic = major_stress_impact_loss
            arbitrary = major_stress_impact_loss
            callous = major_stress_impact_loss

            forgiving = major_stress_impact_gain
            just = major_stress_impact_gain
            generous = major_stress_impact_gain
            compassionate = major_stress_impact_gain
        }

        ai_chance = {
            base = 50
        }
    }
}

genocide_task.0202 = {
    type = character_event
    title = genocide_task.0202.t
    desc = genocide_task.0202.desc
    theme = death
    left_portrait = {
        character = scope:councillor_liege
        animation = anger
    }

    right_portrait = {
        character = scope:councillor
        animation = shame
    }

    lower_left_portrait = scope:target_ruler

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_genocide_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial < high_skill_rating
        }
        any_neighboring_and_across_water_top_liege_realm_owner = {
            any_realm_border_county = {
                any_neighboring_county = {
                    holder.top_liege = scope:county.holder.top_liege
                }
                title_province = {
                    squared_distance = {
                        target = scope:county
                        value < squared_distance_medium
                    }
                }
            }
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = -0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }

        random_neighboring_and_across_water_top_liege_realm_owner = {
            limit = {
                any_realm_border_county = {
                    any_neighboring_county = {
                        holder.top_liege = scope:county.holder.top_liege
                    }
                    title_province = {
                        squared_distance = {
                            target = scope:county
                            value < squared_distance_medium
                        }
                    }
                }
            }
            random_realm_border_county = {
                limit = {
                    any_neighboring_county = {
                        holder.top_liege = scope:county.holder.top_liege
                    }
                    title_province = {
                        squared_distance = {
                            target = scope:county
                            value < squared_distance_medium
                        }
                    }
                }

                save_scope_as = target_county
            }
        }

        every_realm_county = {
            limit = {
                trigger_if = {
                    limit = {
                        allow_genocide_this_province_culture_trigger = { CHARACTER = scope:councillor_liege }
                    }

                    culture = scope:county.culture
                }

                trigger_if = {
                    limit = {
                        allow_genocide_this_province_religion_trigger = { CHARACTER = scope:councillor_liege }
                    }

                    faith = scope:county.faith
                }
            }

            add_county_modifier = {
                modifier = genocide_emigration_modifier
                days = 100
            }
        }

        scope:target_county = {
            add_county_modifier = {
                modifier = genocide_immigration_modifier
                days = 100
            }

            holder.top_liege = {
                save_scope_as = target_ruler
            }
        }

        add_unpressed_claim = scope:target_county

        if = {
            limit = {
                can_set_relation_potential_rival_trigger = {
                    CHARACTER = scope:target_ruler
                }
            }
            set_relation_potential_rival = scope:target_ruler
        }

        stress_impact = {
            paranoid = major_stress_impact_gain
            arrogant = minor_stress_impact_gain
            trusting = minor_stress_impact_loss
            humble = minor_stress_impact_loss
        }
    }

    option = {
        name = genocide_task.0202.a

        ai_chance = {
            base = 50
        }
    }
}

genocide_task.0301 = {
    type = character_event
    title = genocide_task.0301.t
    desc = genocide_task.0301.desc
    theme = martial
    override_background = { reference = burning_building }
    left_portrait = {
        character = cp:councillor_court_chaplain
        animation = personality_zealous
    }

    right_portrait = {
        character = scope:councillor_liege
        animation = throne_room_kneel_1
    }

    lower_center_portrait = {
        character = scope:councillor
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_corruption_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial >= high_skill_rating
        }
        cp:councillor_court_chaplain ?= {
            learning > mediocre_skill_rating
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = 0.15
            offset = inverted_high_skill_rating
        }
        compare_modifier = {
            target = cp:councillor_court_chaplain
            value = learning
            multiplier = 0.05
            offset = inverted_mediocre_skill_rating
        }
    }

    immediate = {
        cp:councillor_court_chaplain = {
            save_scope_as = cp_court_chaplain
        }
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }
    }

    option = {
        name = genocide_task.0301.a

        add_dread = major_dread_gain

        stress_impact = {
            forgiving = major_stress_impact_gain
            just = major_stress_impact_gain
            generous = major_stress_impact_gain
            compassionate = major_stress_impact_gain
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_compassion = -1.0
            }
        }
    }

    option = {
        name = genocide_task.0301.b

        add_piety = 100

        stress_impact = {
            zealous = minor_stress_impact_gain
            sadistic = minor_stress_impact_gain
            callous = minor_stress_impact_gain
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_zeal = 1.0
            }
        }
    }

    option = {
        name = genocide_task.0301.c

        trigger = {
            OR = {
                has_trait = magic_good
                has_trait = magic_good_noninheritable
            }
        }

        add_dread = medium_dread_gain
        add_piety = minor_piety_value
        add_character_modifier = {
            modifier = harmonize_with_force_modifier
            days = 100
        } # TODO: Infusion 2024, add infusion

        ai_chance = {
            base = 250
        }
    }
}

genocide_task.0302 = {
    type = character_event
    title = genocide_task.0302.t
    desc = genocide_task.0302.desc
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = personality_zealous
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_corruption_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial >= high_skill_rating
        }
        OR = {
            OR = {
                OR = {
                    has_trait = magic_good
                    has_trait = magic_good_noninheritable
                }
                scope:councillor = {
                    OR = {
                        has_trait = magic_good
                        has_trait = magic_good_noninheritable
                    }
                }
            }
            scope:county = {
                any_neighboring_county = {
                    any_neighboring_county = {
                        has_beneficial_corruption_this_province_trigger = yes
                    }
                }
            }
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = 0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }
    }

    option = {
        name = genocide_task.0302.a

        trigger = {
            exists = capital_county
            OR = {
                OR = {
                    has_trait = magic_good
                    has_trait = magic_good_noninheritable
                }
                scope:councillor = {
                    OR = {
                        has_trait = magic_good
                        has_trait = magic_good_noninheritable
                    }
                }
            }
        }

        add_piety = 100

        capital_county = {
            add_county_modifier = genocide_channelled_energy_modifier
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_greed = 1.0
            }
        }
    }

    option = {
        name = genocide_task.0302.b

        trigger = {
            scope:county = {
                any_neighboring_county = {
                    any_neighboring_county = {
                        has_beneficial_corruption_this_province_trigger = yes
                    }
                }
            }
        }

        add_prestige = 100

        scope:county = {
            every_neighboring_county = {
                save_temporary_scope_as = temp_county
                if = {
                    limit = {
                        has_beneficial_corruption_this_province_trigger = yes
                    }

                    add_to_list = counties
                }
                every_neighboring_county = {
                    limit = {
                        NOT = {
                            this = scope:county
                        }
                        has_beneficial_corruption_this_province_trigger = yes
                    }

                    add_to_list = counties
                }
            }
        }

        every_in_list = {
            list = counties

            add_county_modifier = {
                modifier = genocide_dispersed_energy_modifier
                days = 100
            }
        }

        ai_chance = {
            base = 50
        }
    }
}

genocide_task.0402 = {
    type = character_event
    title = genocide_task.0402.t
    desc = genocide_task.0402.desc
    theme = martial
    override_background = { reference = burning_building }

    left_portrait = {
        character = scope:councillor_liege
        animation = happiness
    }

    right_portrait = {
        character = scope:councillor
        animation = marshal
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_cleansing_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial >= high_skill_rating
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = 0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }
    }

    option = {
        name = genocide_task.0402.a

        add_dread = major_dread_gain

        stress_impact = {
            forgiving = major_stress_impact_gain
            just = major_stress_impact_gain
            generous = major_stress_impact_gain
            compassionate = major_stress_impact_gain
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_compassion = -1.0
            }
        }
    }

    option = {
        name = genocide_task.0402.b

        add_prestige = 100

        stress_impact = {
            zealous = minor_stress_impact_gain
            sadistic = minor_stress_impact_gain
            callous = minor_stress_impact_gain
            just = minor_stress_impact_loss
            generous = minor_stress_impact_loss
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_compassion = 1.0
            }
        }
    }

    option = {
        name = genocide_task.0402.c
        skill = learning

        trigger = {
            learning >= 20
        }

        stress_impact = {
            zealous = minor_stress_impact_loss
            sadistic = minor_stress_impact_loss
            forgiving = medium_stress_impact_gain
            just = minor_stress_impact_gain
            generous = medium_stress_impact_gain
            compassionate = major_stress_impact_gain
        }

        add_dread = medium_dread_gain
        add_piety = minor_prestige_value
        add_character_modifier = {
            modifier = sacrificed_cleansing_targets_modifier
            days = 100
        }

        ai_chance = {
            base = 250
        }
    }
}

genocide_task.0401 = {
    type = character_event
    title = genocide_task.0401.t
    desc = genocide_task.0401.desc
    theme = martial
    override_background = { reference = burning_building }
    left_portrait = {
        character = scope:councillor_liege
        animation = ecstasy
    }

    right_portrait = {
        character = scope:councillor
        animation = marshal
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_cleansing_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial >= high_skill_rating
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = 0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }
    }

    option = {
        name = genocide_task.0401.a

        scope:county = {
            custom_tooltip = genocide_task.0401.a.progress
            change_variable = {
                name = purge_population_current_progress
                add = 4
            }
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_zeal = 1.0
            }
        }
    }

    option = {
        name = genocide_task.0401.b

        spawn_army = {
            name = genocide_task.0401.army_name
            levies = {
                scope:county = {
                    add = {
                        value = total_county_levies
                        divide = 10
                    }
                }
                if = {
                    limit = {
                        highest_held_title_tier = tier_county
                    }
                    add = 50
                }
                else_if = {
                    limit = {
                        highest_held_title_tier = tier_duchy
                    }

                    add = 100
                }
                else_if = {
                    limit = {
                        highest_held_title_tier = tier_kingdom
                    }

                    add = 250
                }
                else_if = {
                    limit = {
                        highest_held_title_tier = tier_empire
                    }

                    add = 500
                }
            }
            location = scope:county.title_province
            inheritable = no
            uses_supply = yes
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_greed = 1.0
            }
        }
    }
}

genocide_task.0501 = {
    type = character_event
    title = genocide_task.0501.t
    desc = genocide_task.0501.desc
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = happiness
    }

    lower_left_portrait = {
        character = scope:councillor
    }

    right_portrait = {
        character = scope:champion
        animation = admiration
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_genocide_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial >= high_skill_rating
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = 0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }

        genocide_spawn_champion_effect = { CULTURE = scope:councillor_liege.culture FAITH = scope:councillor_liege.faith GOOD = yes }
    }

    option = {
        name = genocide_task.0501.a

        add_prestige = 100
        add_courtier = scope:champion

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_greed = 1.0
            }
        }
    }

    option = {
        name = genocide_task.0501.b

        add_piety = 50
        add_character_modifier = {
            modifier = genocide_local_champion_modifier
            days = 100
        }
        scope:champion = {
            silent_disappearance_effect = yes
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_zeal = 1.0
            }
        }
    }
}

genocide_task.0502 = {
    type = character_event
    title = genocide_task.0502.t
    desc = genocide_task.0502.desc
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = personality_zealous
    }

    trigger = {
        scope:county = {
            has_county_modifier = ongoing_genocide_modifier
        }
        exists = cp:councillor_marshal
        scope:councillor = cp:councillor_marshal
        scope:councillor ?= {
            martial >= high_skill_rating
        }
        OR = {
            OR = {
                has_trait = administrator
                scope:councillor = {
                    has_trait = administrator
                }
            }
            scope:county = {
                any_neighboring_county = {
                    any_neighboring_county = {
                        OR = {
                            culture = scope:councillor_liege.culture
                            faith = scope:councillor_liege.faith
                        }
                    }
                }
            }
        }
    }

    weight_multiplier = {
        base = 1
        compare_modifier = {
            target = scope:councillor
            value = martial
            multiplier = 0.2
            offset = inverted_high_skill_rating
        }
    }

    immediate = {
        set_variable = {
            name = had_genocide_task_side_effect
            value = yes
            days = genocide_task_side_effect_cooldown
        }
    }

    option = {
        name = genocide_task.0502.a

        trigger = {
            exists = capital_county
            OR = {
                has_trait = administrator
                scope:councillor = {
                    has_trait = administrator
                }
            }
        }

        add_gold = 50

        capital_county = {
            add_county_modifier = genocide_focused_resources_modifier
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_greed = 1.0
            }
        }
    }

    option = {
        name = genocide_task.0502.b

        trigger = {
            scope:county = {
                any_neighboring_county = {
                    any_neighboring_county = {
                        OR = {
                            culture = scope:councillor_liege.culture
                            faith = scope:councillor_liege.faith
                        }
                    }
                }
            }
        }

        add_prestige = 100

        scope:county = {
            every_neighboring_county = {
                save_temporary_scope_as = temp_county
                if = {
                    limit = {
                        OR = {
                            culture = scope:councillor_liege.culture
                            faith = scope:councillor_liege.faith
                        }
                    }

                    add_to_list = counties
                }
                every_neighboring_county = {
                    limit = {
                        NOT = {
                            this = scope:county
                        }
                        OR = {
                            culture = scope:councillor_liege.culture
                            faith = scope:councillor_liege.faith
                        }
                    }

                    add_to_list = counties
                }
            }
        }

        every_in_list = {
            list = counties

            add_county_modifier = {
                modifier = genocide_dispersed_resources_modifier
                days = 100
            }
        }

        ai_chance = {
            base = 50

            ai_value_modifier = {
                ai_compassion = 1.0
            }
        }
    }
}

genocide_task.2001 = {
    type = character_event
    title = genocide_task.2001.t
    desc = {
        first_valid = {
            triggered_desc = {
                trigger = {
                    OR = {
                        can_corrupt_specific_trigger = { BEING = being_void MAGIC = shadow }
                        can_corrupt_specific_trigger = { BEING = being_demon MAGIC = disorder }
                        can_corrupt_specific_trigger = { BEING = being_undead MAGIC = death }
                    }
                }
                desc = genocide_task.2001.desc.dark
            }
            triggered_desc = {
                trigger = {
                    can_corrupt_specific_trigger = { BEING = being_light MAGIC = light }
                }
                desc = genocide_task.2001.desc.light
            }
            triggered_desc = {
                trigger = {
                    can_corrupt_specific_trigger = { BEING = being_life MAGIC = life }
                }
                desc = genocide_task.2001.desc.nature
            }
            triggered_desc = {
                trigger = {
                    can_corrupt_specific_trigger = { BEING = being_order MAGIC = order }
                }
                desc = genocide_task.2001.desc.arcane
            }
        }
    }
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = happiness
    }
    right_portrait = {
        character = scope:holder
        trigger = {
            exists = scope:holder
        }
        animation = grief
    }

    immediate = {
        if = {
            limit = {
                scope:county = {
                    NOT = {
                        holder = scope:councillor_liege
                    }
                }
            }

            scope:county.holder = {
                save_scope_as = holder
            }
        }

        scope:county = {
            corrupt_county_effect = { ON_START = no }
        }
    }

    option = {
        name = genocide_task.2001.a
    }
}

genocide_task.2101 = {
    type = character_event
    title = genocide_task.2101.t
    desc = {
        first_valid = {
            triggered_desc = {
                trigger = {
                    scope:county = {
                        OR = {
                            has_county_modifier = county_corruption_void_modifier
                            has_county_modifier = county_corruption_fel_modifier
                            has_county_modifier = county_corruption_death_modifier
                        }
                    }
                }
                desc = genocide_task.2101.desc.dark
            }
            triggered_desc = {
                trigger = {
                    scope:county = {
                        has_county_modifier = county_corruption_light_modifier
                    }
                }
                desc = genocide_task.2101.desc.light
            }
            triggered_desc = {
                trigger = {
                    scope:county = {
                        has_county_modifier = county_corruption_life_modifier
                    }
                }
                desc = genocide_task.2101.desc.nature
            }
            triggered_desc = {
                trigger = {
                    scope:county = {
                        has_county_modifier = county_corruption_arcane_modifier
                    }
                }
                desc = genocide_task.2101.desc.arcane
            }
        }
    }
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = happiness
    }
    right_portrait = {
        character = scope:holder
        trigger = {
            exists = scope:holder
        }
        animation = grief
    }

    immediate = {
        show_as_tooltip = {
            if = {
                limit = {
                    scope:county = {
                        NOT = {
                            holder = scope:councillor_liege
                        }
                    }
                }

                scope:county.holder = {
                    save_scope_as = holder
                }
            }

            scope:county = {
                cleanse_county_effect = yes
            }
        }
    }

    option = {
        name = genocide_task.2101.a

        hidden_effect = {
            if = {
                limit = {
                    scope:county = {
                        NOT = {
                            holder = scope:councillor_liege
                        }
                    }
                }

                scope:county.holder = {
                    save_scope_as = holder
                }
            }

            scope:county = {
                cleanse_county_effect = yes
            }
        }
    }
}

genocide_task.2201 = {
    type = character_event
    title = genocide_task.2201.t
    desc = {
        desc = genocide_task.2201.desc
        triggered_desc = {
            trigger = {
                scope:holder = {
                    NOT = {
                        this = scope:councillor_liege
                    }
                    NAND = {
                        culture = scope:councillor_liege.culture
                        faith = scope:councillor_liege.faith
                    }
                }
            }
            desc = genocide_task.2201.desc.holder
        }
    }
    theme = martial
    left_portrait = {
        character = scope:councillor_liege
        animation = happiness
    }
    right_portrait = {
        character = scope:holder
        trigger = {
            exists = scope:holder
        }
        animation = grief
    }

    immediate = {
        if = {
            limit = {
                scope:county = {
                    NOT = {
                        holder = scope:councillor_liege
                    }
                }
            }

            scope:county.holder = {
                save_scope_as = holder
            }
        }

        scope:county = {
            purge_population_effect = yes
        }
    }

    option = {
        name = genocide_task.2201.a

        trigger = {
            NOT = {
                exists = scope:holder
            }
        }
    }

    option = {
        name = genocide_task.2201.a.holder

        trigger = {
            scope:holder ?= {
                NOT = {
                    this = scope:councillor_liege
                }
                NAND = {
                    culture = scope:councillor_liege.culture
                    faith = scope:councillor_liege.faith
                }
            }
        }
    }

    option = {
        name = genocide_task.2201.b

        trigger = {
            scope:holder ?= {
                NOT = {
                    this = scope:councillor_liege
                }
                NAND = {
                    culture = scope:councillor_liege.culture
                    faith = scope:councillor_liege.faith
                }
            }
        }

        scope:county = {
            create_title_and_vassal_change = {
                type = usurped
                add_claim_on_loss = yes
                save_scope_as = change
            }

            change_title_holder = {
                holder = scope:councillor_liege
                change = scope:change
                take_baronies = yes
            }

            resolve_title_and_vassal_change = scope:change
        }
    }

    option = {
        name = genocide_task.2201.c

        trigger = {
            scope:holder ?= {
                NOT = {
                    this = scope:councillor_liege
                }
                NAND = {
                    culture = scope:councillor_liege.culture
                    faith = scope:councillor_liege.faith
                }
                any_held_title = {
                    tier = tier_county
                    count = 1
                }
            }
        }

        scope:county = {
            create_title_and_vassal_change = {
                type = usurped
                add_claim_on_loss = yes
                save_scope_as = change
            }

            change_title_holder = {
                holder = scope:councillor_liege
                change = scope:change
                take_baronies = yes
            }

            resolve_title_and_vassal_change = scope:change
        }

        scope:holder = {
            override_death_killer_effect = {
                death_reason = death_execution
                killer = scope:councillor_liege
            }
        }
    }
}