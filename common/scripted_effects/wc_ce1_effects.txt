
########################
## Legends Effects
########################

wc_generate_religion_descent_effect = { 
	## Groups that have just one high god (or just one religion...)
	if = { 
		limit = { $FAITH$.religion = religion:air_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = ALAKIR_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:ape_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = MONKEY_KING_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:arcane_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = MAGIC_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:daradorism }
		wc_generate_godly_descent_seed_support_effect = { GOD = ANCESTORS_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:deathbringer }
		wc_generate_godly_descent_seed_support_effect = { GOD = DEATH_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:druidism_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = ELUNE_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:earth_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = THERAZANE_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:fel_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = DISORDER_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:fire_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = RAGNAROS_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:grond_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = GORGOG_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:tyrism_religion }
		wc_generate_godly_descent_seed_support_effect = { GOD = LIGHT_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:lizard_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = KROS_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:naarism }
		wc_generate_godly_descent_seed_support_effect = { GOD = LIGHT_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:necromancy_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = DEATH_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:nerub_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = ALLSEEING_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:pandaren_religion_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = SHAOHAO_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:shadow_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = SHADOW_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:titanic_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = AMANTHUL_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:void_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = VOID_NAME }
	}
	## Groups that have all different high gods
	#avian_group
	else_if ={ 
		limit = { $FAITH$ = faith:setheism }
		wc_generate_godly_descent_seed_support_effect = { GOD = SETHE_NAME }
	}
	else_if ={ 
		limit = { $FAITH$ = faith:anzuism }
		wc_generate_godly_descent_seed_support_effect = { GOD = ANZU_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:rukhmarism }
		wc_generate_godly_descent_seed_support_effect = { GOD = RUKHMAR_NAME }
	}
	#loa_group
	else_if = { 
		limit = { $FAITH$ = faith:zandism }
		wc_generate_godly_descent_seed_support_effect = { GOD = REZAN_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:gurubism }
		wc_generate_godly_descent_seed_support_effect = { GOD = BWONSAMDI_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:drakkism }
		wc_generate_godly_descent_seed_support_effect = { GOD = MAMTOTH_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:amism }
		wc_generate_godly_descent_seed_support_effect = { GOD = NALORAKK_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:farrism }
		wc_generate_godly_descent_seed_support_effect = { GOD = MUEHZALA_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:cult_of_hakkar }
		wc_generate_godly_descent_seed_support_effect = { GOD = HAKKAR_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:cult_of_sethraliss }
		wc_generate_godly_descent_seed_support_effect = { GOD = SETHRALISS_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:cult_of_ariwo }
		wc_generate_godly_descent_seed_support_effect = { GOD = ARIWO_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:cult_of_torga }
		wc_generate_godly_descent_seed_support_effect = { GOD = TORGA_NAME }
	}
	# secular_group
	else_if = { 
		limit = { $FAITH$ = faith:rationalism }
		wc_generate_godly_descent_seed_support_effect = { GOD = ANCESTORS_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:cult_of_wealth }
		wc_generate_godly_descent_seed_support_effect = { GOD = FORTUNA_NAME }
	}
	# shamanism_group
	else_if = { 
		limit = { $FAITH$ = faith:tuskarr_religion }
		wc_generate_godly_descent_seed_support_effect = { GOD = OACHANOA_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:earth_mother_worship }
		wc_generate_godly_descent_seed_support_effect = { GOD = EARTH_MOTHER_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:shamanism_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = ANCESTORS_NAME }
	}
	# shathgral_group
	else_if = { 
		limit = { $FAITH$ = faith:cthun_worship }
		wc_generate_godly_descent_seed_support_effect = { GOD = CTHUN_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:ghuun_worship }
		wc_generate_godly_descent_seed_support_effect = { GOD = GHUUN_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:yshaarj_worship }
		wc_generate_godly_descent_seed_support_effect = { GOD = YSHAARJ_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:nzoth_worship }
		wc_generate_godly_descent_seed_support_effect = { GOD = NZOTH_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:yoggsaron_worship }
		wc_generate_godly_descent_seed_support_effect = { GOD = YOGG_SARON_NAME }
	}
	# water_group
	else_if = { 
		limit = { $FAITH$ = faith:arkkoroc }
		wc_generate_godly_descent_seed_support_effect = { GOD = ARKKOROC_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:tidemother }
		wc_generate_godly_descent_seed_support_effect = { GOD = TIDEMOTHER_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:water_group }
		wc_generate_godly_descent_seed_support_effect = { GOD = NEPTULON_NAME }
	}
	# draconism_religion
	else_if = { 
		limit = { $FAITH$ = faith:neltharism }
		wc_generate_godly_descent_seed_support_effect = { GOD = KHAZGOROTH_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:malygosism }
		wc_generate_godly_descent_seed_support_effect = { GOD = NORGANNON_NAME }
	}
	else_if = { 
		limit = { $FAITH$ = faith:nozdormism }
		wc_generate_godly_descent_seed_support_effect = { GOD = AMANTHUL_NAME }
	}
	else_if = { 
		limit = { $FAITH$.religion = religion:draconism_religion }
		wc_generate_godly_descent_seed_support_effect = { GOD = EONAR_NAME }
	}
	# fallback
	else = { 
		limit = { $FAITH$.religion = religion:apostasism }
		wc_generate_godly_descent_seed_support_effect = { GOD = ANCESTORS_NAME }
	}
}

wc_generate_godly_descent_seed_support_effect = {
	create_legend_seed = {
		type = holy
		quality = famed
		chronicle = godly_descent
		properties = {
			god = flag:$GOD$
			title = root.primary_title
		}
	}
}

wc_mark_lore_legend_as_done = { 
	if = { # Warcraft - remove non lore characters
		limit = {
			legend_property:ancestor ?= character:1005 # Thoradin of Arathor 
			legend_property:title ?= title:e_arathor
		}
		set_global_variable = {
			name = thoradins_successor_legend
			value = yes
		}
	}
	else_if = {
		limit = {
			legend_property:ancestor ?= character:75000 # Modimus Anvilmar
			legend_property:title ?= title:k_ironforge
		}
		set_global_variable = {
			name = blood_of_anvilmar_legend
			value = yes
		}
	}
	else_if = {
		limit = {
			legend_property:culture ?= culture:old_dwarven
			legend_property:title ?= title:e_khaz_modan
			legend_property:original_region = geographical_region:world_eastern_kingdoms_khaz_modan
		}
		set_global_variable = {
			name = legacy_of_the_three_hammers_legend
			value = yes
		}
	}
	else_if = {
		limit = {
			legend_property:culture ?= culture:highborne
			legend_property:title ?= title:e_broken_isles
			legend_property:original_region ?= geographical_region:world_broken_isles
		}
		set_global_variable = {
			name = mender_of_the_sundering_legend
			value = yes
		}
	}
	else_if = {
		limit = {
			legend_property:ancestor_flag ?= flag:mereldar
		}
		set_global_variable = {
			name = mereldars_issue_legend
			value = yes
		}
	}
	else_if = { 
		limit = { 
			legend_property:ancestor = character:huln_highmountain 
		}
		set_global_variable = { 
			name = descended_of_huln_legend
			value = yes
		}
	}
}

wc_get_appropriate_exotic_location = { 
	random_list = { 
		50 = { 
			trigger = { culture = { has_cultural_pillar = heritage_draconic } }
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_dragon_isles
			}
		}
		100 = { 
			trigger = { 
				pandarian_isolation_trigger = yes
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_beyond_the_mists
			}
		}
		# Broken Isles -> Everyone not neighboring it
		10 = { 
			trigger = { 
				NOR = { 
					any_character_to_title_neighboring_and_across_water_county = {
						title_province = { geographical_region = geographical_region:world_broken_isles }
					}
					wc_well_traveled_culture_trigger = yes
					pandarian_isolation_trigger = yes
				} 
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_broken_isles
			}
		}
		# Zandalar -> Everyone not neighboring it
		10 = { 
			trigger = { 
				NOR = { 
					any_character_to_title_neighboring_and_across_water_county = {
						title_province = { geographical_region = geographical_region:world_south_seas_zandalar }
					}
					culture = { 
						has_human_heritage_trigger = no
						has_elven_heritage_trigger = no
						has_cultural_pillar = heritage_dwarven 
						has_cultural_pillar = heritage_gnomish
					}
					wc_well_traveled_culture_trigger = yes
					pandarian_isolation_trigger = yes
				} 
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_zandalar
			}
		}
		# Northrend -> Everyone not neighboring it
		10 = { 
			trigger = { 
				NOR = { 
					any_character_to_title_neighboring_and_across_water_county = {
						title_province = { geographical_region = geographical_region:world_northrend }
					}
					wc_well_traveled_culture_trigger = yes
					pandarian_isolation_trigger = yes
				} 
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_northrend
			}
		}
		# Pandaria -> Everyone not actually living there (even zandalar supposedly is out of contact)
		10 = { 
			trigger = { 
				NOT = { 
					capital_county = {
						title_province = { geographical_region = world_pandaria }
					} 
				}
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_pandaria
			}
		}
		# Kalimdor -> Everyone on EK 
		10 = { 
			trigger = { 
				NOR = { 
					any_character_to_title_neighboring_and_across_water_county = {
						title_province = { geographical_region = geographical_region:world_kalimdor }
					}
					wc_well_traveled_culture_trigger = yes
					pandarian_isolation_trigger = yes
				} 
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_kalimdor
			}
		}
		# EK -> Everyone on Kalimdor who didnt come through the DP
		10 = { 
			trigger = { 
				NOR = { 
					any_character_to_title_neighboring_and_across_water_county = {
						title_province = { geographical_region = geographical_region:world_eastern_kingdoms }
					}
					wc_well_traveled_culture_trigger = yes
					draenor_culture_trigger = yes
					pandarian_isolation_trigger = yes
				} 
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_eastern_kingdoms
			}
		}
		# Azjol'Nerub -> Death and Void religions are aware of it
		10 = { 
			trigger = { 
				religion = { 
					OR = { 
						religion = religion:void_group 
						religion = religion:deathbringer 
					}
				}
				NOT = { culture = culture:nerubian }
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_azjol_nerub
			}
		}
		# Uldum -> Dwarves and gnomes knew the mythical lands of the titans
		10 = { 
			trigger = { 
				culture = { 
					OR = { 
						has_cultural_pillar = heritage_dwarven
						has_cultural_pillar = heritage_gnomish
					}
				}
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_uldum
			}
		}
		# Kaldorei -> No elf would ever buy this, but maybe other cultures would...
		10 = { 
			trigger = { 
				has_trait_with_flag = elven_family
				culture = { 
					has_elven_heritage_trigger = no
				}
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_kaldorei_empire
			}
		}
		# Naz'jatar -> Exotic to anyone not Naga
		10 = { 
			trigger = { 
				culture = { 
					OR = { 
						has_cultural_pillar = heritage_azsharic
					}
				}
				pandarian_isolation_trigger = no
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_nazjatar
			}
		}
		# Draenor -> Exotic to anyone not from draenor until after dark portal closed, then everyone
		10 = { 
			trigger = { 
				culture = { 
					NOT = { 
						draenor_culture_trigger = yes
						is_target_in_global_variable_list = { name = unavailable_unique_events target = flag:beyond_dark_portal }
					}
				}
				pandarian_isolation_trigger = no
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_draenor
			}
		}
		# Argus -> Exotic to anyone not a Demon
		10 = { 
			trigger = { 
				culture = { 
					NOT = { 
						has_cultural_pillar = heritage_demonic
					}
				}
				pandarian_isolation_trigger = no
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_argus
			}
		}
		# The Elemental Planes -> Exotic to anyone who isnt of Order religion or Order magic user (they dont care)
		10 = { 
			trigger = { 
				NOT = { faith.religion = { is_in_family = rf_order } }
			}
			modifier = { 
				trigger = { faith.religion = { is_in_family = rf_elemental } }
				add = 40 # they really love elemental stuff, obvi
			}
			get_elemental_plane_for_legend = yes
		}
		# The Black Kingdom -> Void religions, quiraji, nerubian, titans, dragons are aware of it
		10 = { 
			trigger = { 
				OR = { 
					faith.religion = religion:void_group
					culture = { has_cultural_pillar = heritage_aqir }
					culture = { has_cultural_pillar = heritage_draconic }
					culture = { has_cultural_pillar = heritage_ulduaric } 
				}
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_black_empire
			}
		}
		# Arathor -> Only humans gaf about this
		10 = { 
			trigger = { has_human_heritage_trigger = yes }
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_arathor_empire
			}
		}
		# Gorian -> Only ogres gaf about this
		10 = { 
			trigger = { has_cultural_pillar = heritage_gorian }
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_gorian_empire
			}
		}
		# Empire of Zul -> Only trolls & loa worshippers care about this
		10 = { 
			trigger = { 
				OR = { 
					culture = { has_cultural_pillar = heritage_zulite } 
					faith.religion = religion:loa_group 
				}
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_zul_empire
			}
		}
		# Twisting Nether -> Fallback
		1 = { 
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_twisting_nether
			}
		}
	}
}


## Helpers for wc_get_appropriate_exotic_location
get_elemental_plane_for_legend = { 
	random_list = {
		3 = { 
			modifier = { 
				trigger = { faith.religion = religion:air_group }
				factor = 100
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_plane_air
			}
		}
		3 = { 
			modifier = { 
				trigger = { faith.religion = religion:fire_group }
				factor = 100
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_plane_fire
			}
		}
		3 = { 
			modifier = { 
				trigger = { faith.religion = religion:earth_group }
				factor = 100
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_plane_earth
			}
		}
		3 = { 
			modifier = { 
				trigger = { faith.religion = religion:water_group }
				factor = 100
			}
			save_scope_value_as = {
				name = exotic_location
				value = flag:legendary_plane_water
			}
		}
	}
}

########################
## Epidemic Effects
########################

# replace a random chance to infect with this effect unless youre ok with elves and dragons getting sick as often as humans and wolvar
# NOTE: DO NOT use this inside of an epidemic in place of a value from ce1_epidemics_values. instead use one from one of our own values.
wc_chance_to_infect_with_epidemic = { 
	random = { 
		chance = { 
			value = $base$	
			multiply = wc_standard_epidemic_infect_chance_percent_reduction
			min = 1
		}
		infect_with_epidemic = scope:epidemic_scope
	}
}

wc_chance_to_infect_with_epidemic_plus_message = {
	random = { 
		chance = { 
			value = $base$	
			multiply = wc_standard_epidemic_infect_chance_percent_reduction
			min = 1
		}
		send_interface_message = {
			title = $message$
			left_icon = $target$
			$target$ = { infect_with_epidemic = scope:epidemic_scope }
		}
	}
}