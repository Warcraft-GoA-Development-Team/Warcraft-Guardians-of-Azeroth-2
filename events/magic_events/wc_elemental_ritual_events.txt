namespace = wc_elemental_ritual_events

######################################
# 1000 - 1499
# Fire Ritual (Spirit) By Shatterstar & Dione
######################################

# Prepare for your journey to the plane
wc_elemental_ritual_events.1001 = { 
	title = wc_elemental_ritual_events.1001.title
	desc = wc_elemental_ritual_events.1001.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	#begin event
	option = { 
		name = wc_elemental_ritual_events.1001.a
		trigger_event = { 
			id = wc_elemental_ritual_events.1002
			days = { 5 10 }
		}
	}

	#cancel event
	option = { 
		name = wc_elemental_ritual_events.1001.b
		trigger_event = { 
			id = wc_elemental_ritual_events.1005
			days = 1
		}
	}
}

# Start the ritual to enter the plane
wc_elemental_ritual_events.1002 = { 
	title = wc_elemental_ritual_events.1002.title
	desc = wc_elemental_ritual_events.1002.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	# call on air spirits for additional aid, all air spells go on cooldown
	option = { 
		name = wc_elemental_ritual_events.1002.air
		custom_tooltip = wc_air_spirits_cd
		trigger = { 
			OR = { 
				perks_in_tree = { tree = elemental_air_magic_tree_1 value > 3 }
				perks_in_tree = { tree = elemental_air_magic_tree_2 value > 3 }
			}
		}
		if = {
			limit = {
				has_global_variable_list = elemental_air_spells
			}
			every_in_global_list = {
				variable = elemental_air_spells
				save_scope_as = spell
				execute_scoped_spell_effect = {
					SPELL = scope:spell
					EFFECT = put_spell_on_cooldown_effect
				}
			}
		}
		random_list = {
			50 = {
				modifier = {
					add = 10
					wc_elemental_air_favour_current_value > wc_spirit_elemental_favour_threshold_value
				}
				modifier = {
					add = wc_elemental_air_favour_current_value
					is_alive = yes
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1003
					days = 3
				}
				custom_tooltip = wc_translocation_success
			}
			40 = {
				trigger_event = {
					id = wc_elemental_ritual_events.1004
					days = 3
				}
				custom_tooltip = wc_translocation_fail
			}
		}
	}

	#call on earth spirits for additional aid, all earth spells go on cooldown
	option = { 
		name = wc_elemental_ritual_events.1002.earth
		custom_tooltip = wc_earth_spirits_cd
		trigger = { 
			OR = { 
				perks_in_tree = { tree = elemental_earth_magic_tree_1 value > 3 }
				perks_in_tree = { tree = elemental_earth_magic_tree_2 value > 3 }
			}
		}
		if = {
			limit = {
				has_global_variable_list = elemental_earth_spells
			}
			every_in_global_list = {
				variable = elemental_earth_spells
				save_scope_as = spell
				execute_scoped_spell_effect = {
					SPELL = scope:spell
					EFFECT = put_spell_on_cooldown_effect
				}
			}
		}
		random_list = {
			50 = {
				modifier = {
					add = 10
					wc_elemental_earth_favour_current_value > wc_spirit_elemental_favour_threshold_value
				}
				modifier = {
					add = wc_elemental_earth_favour_current_value
					is_alive = yes
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1003
					days = 3
				}
				custom_tooltip = wc_translocation_success
			}
			40 = {
				trigger_event = {
					id = wc_elemental_ritual_events.1004
					days = 3
				}
				custom_tooltip = wc_translocation_fail
			}
		}
	}

	#call on water spirits for additional aid, all water spells go on cooldown
	option = { 
		name = wc_elemental_ritual_events.1002.water
		custom_tooltip = wc_water_spirits_cd
		trigger = { 
			OR = { 
				perks_in_tree = { tree = elemental_water_magic_tree_1 value > 3 }
				perks_in_tree = { tree = elemental_water_magic_tree_2 value > 3 }
			}
		}
		if = {
			limit = {
				has_global_variable_list = elemental_water_spells
			}
			every_in_global_list = {
				variable = elemental_water_spells
				save_scope_as = spell
				execute_scoped_spell_effect = {
					SPELL = scope:spell
					EFFECT = put_spell_on_cooldown_effect
				}
			}
		}
		random_list = {
			50 = {
				modifier = {
					add = 10
					wc_elemental_water_favour_current_value > wc_spirit_elemental_favour_threshold_value
				}
				modifier = {
					add = wc_elemental_water_favour_current_value
					is_alive = yes
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1003
					days = 3
				}
				custom_tooltip = wc_translocation_success
			}
			40 = {
				trigger_event = {
					id = wc_elemental_ritual_events.1004
					days = 3
				}
				custom_tooltip = wc_translocation_fail
			}
		}
	}

	#hope you have enough aid 
	option = { 
		name = wc_elemental_ritual_events.1002.none
		random_list = {
			50 = {
				modifier = {
					add = 5
					wc_elemental_fire_favour_current_value > wc_spirit_elemental_favour_threshold_value
				}
				modifier = {
					add = wc_elemental_fire_favour_current_value
					is_alive = yes
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1003
					days = 3
				}
				custom_tooltip = wc_translocation_success
			}
			40 = {
				trigger_event = {
					id = wc_elemental_ritual_events.1004
					days = 3
				}
				custom_tooltip = wc_translocation_fail
			}
		}
	}
}

# Successful Ritual
wc_elemental_ritual_events.1003 = { 
	title = wc_elemental_ritual_events.1003.title
	desc = wc_elemental_ritual_events.1003.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	# Try to get their attention
	option = { 
		name = wc_elemental_ritual_events.1003.a
		random_list = {
			40 = {
				custom_tooltip = wc_elements_ignore				
				trigger_event = {
					id = wc_elemental_ritual_events.1100
					days = { 10 20 }
				}
			}
			60 = {
				modifier = {
					add = 10
					wc_elemental_air_favour_current_value > wc_spirit_elemental_favour_threshold_value
				}
				modifier = {
					add = wc_elemental_air_favour_current_value
					is_alive = yes
				}
				custom_tooltip = wc_elements_welcome
				trigger_event = {
					id = wc_elemental_ritual_events.1101
					days = { 10 20 }
				}
			}
		}
	}

	# option = { 
		
	# }

	# option = { 
		
	# }
}

# Ritual Encounters a Problem
wc_elemental_ritual_events.1004 = { 
	title = wc_elemental_ritual_events.1004.title
	desc = wc_elemental_ritual_events.1004.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	# Give Up
	option = { 
		name = wc_elemental_ritual_events.1004.giveup
		trigger_event = { 
			id = wc_elemental_ritual_events.1005
			days = 1
		}
	}

	# Force into the plane
	option = { 
		name = wc_elemental_ritual_events.1004.force
		wc_change_amount_element_favour_effect = {
			ELEMENT = elemental_fire
			CHANGE = subtract
			VALUE = 10
		}
		add_character_flag = {
			flag = wc_elements_used_force
			days = 90
		}
		random_list = {
			80 = {
				custom_tooltip = wc_elements_ignore				
				trigger_event = {
					id = wc_elemental_ritual_events.1100
					days = { 10 20 }
				}
			}
			20 = {
				custom_tooltip = wc_elements_welcome
				trigger_event = {
					id = wc_elemental_ritual_events.1101
					days = { 10 20 }
				}
			}
		}
	}

	# Offer your power to the elements
	option = { 
		name = wc_elemental_ritual_events.1004.sac
		add_character_modifier = {
			modifier = wc_elemental_sacrifice_modifier
			years = 2
		}
		random_list = {
			30 = {
				custom_tooltip = wc_elements_ignore
				trigger_event = {
					id = wc_elemental_ritual_events.1100
					days = { 10 20 }
				}
			}
			70 = {
				custom_tooltip = wc_elements_welcome
				trigger_event = {
					id = wc_elemental_ritual_events.1101
					days = { 10 20 }
				}
			}
		}
	}
}

# End the event early
wc_elemental_ritual_events.1005 = { 
	title = wc_elemental_ritual_events.1005.title
	desc = wc_elemental_ritual_events.1005.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	

	option = { 
		name = wc_elemental_ritual_events.1005.a
		# remove some of the cd
		if = {
			limit = {
				has_variable = planar_fire_cd
			}
			change_variable = {
				name = planar_fire_cd
				add = -1000
			}
		}
		wc_change_amount_element_favour_effect = {
			ELEMENT = elemental_fire
			CHANGE = add
			VALUE = 10
		}
		remove_character_flag = any_ritual_cd
	}
}

# Arrival on the Plane - Elements Ignore You
wc_elemental_ritual_events.1100 = { 
	title = wc_elemental_ritual_events.1100.title
	desc = {
		first_valid = {
			triggered_desc = { 
				trigger = {
					has_character_flag = wc_elements_used_force
				}
				desc = wc_elemental_rituals_events.1100.desc_forced
			}
			triggered_desc = { 
				trigger = {
					has_character_modifier = wc_elemental_sacrifice_modifier
				}
				desc = wc_elemental_rituals_events.1100.desc_sac
			}
		}
		desc = wc_elemental_ritual_events.1100.desc
	}
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	

	# all options lead to 1110
	# use diplomacy to try to get their attention
	option = { 
		name = wc_elemental_ritual_events.1100.diplomacy
		trigger = {
			diplomacy >= 10
		}
		duel = {
			skill = diplomacy
			value = decent_skill_rating
			50 = {	
				custom_tooltip = wc_elemental_ritual_events.1100.success	
				send_interface_message = {
					title = wc_elemental_ritual_events.1100.success	
					trigger_event = {
						id = wc_elemental_ritual_events.1101
						days = 5
					}		
				}		
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
			}
			50 = {
				custom_tooltip = wc_elemental_ritual_events.1100.fail
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1110
					days = { 20 50 }
				}
				random_list = {
					90 = {}
					10 = {
						send_interface_message = {
							title = wc_elemental_ritual_events.1100.offended
							wc_change_amount_element_favour_effect = {
								ELEMENT = elemental_fire
								CHANGE = subtract
								VALUE = 5
							}
						}
					}
				}
			}
		}
	}
	# use a display of fire magic to get their attention
	option = { 
		name = wc_elemental_ritual_events.1100.magic
		duel = {
			skill = prowess
			value = decent_skill_rating
			50 = {	
				modifier = {
					add = wc_mp_value
					wc_mp_value >= 10
				}
				custom_tooltip = wc_elemental_ritual_events.1100.success	
				send_interface_message = {
					title = wc_elemental_ritual_events.1100.success	
					trigger_event = {
						id = wc_elemental_ritual_events.1101
						days = 5
					}		
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
			}
			50 = {
				custom_tooltip = wc_elemental_ritual_events.1100.fail
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1110
					days = { 20 50 }
				}
				random_list = {
					90 = {}
					10 = {
						send_interface_message = {
							title = wc_elemental_ritual_events.1100.offended
							wc_change_amount_element_favour_effect = {
								ELEMENT = elemental_fire
								CHANGE = subtract
								VALUE = 5
							}
						}
						
					}
				}
			}
		}
	}

	# summon a terrestrial elemental to guide you
	option = { 
		name = wc_elemental_ritual_events.1100.terr
		trigger = {
			OR = {
				wc_mp_value >= 30
				has_trait = user_of_elemental_fire_spirit_magic_3
				has_trait = user_of_elemental_fire_spirit_magic_4
				has_trait = user_of_elemental_fire_spirit_magic_5
				has_trait = user_of_elemental_fire_magic_3
				has_trait = user_of_elemental_fire_magic_4
				has_trait = user_of_elemental_fire_magic_5
			}
		}
		add_character_flag = {
			flag = wc_ritual_terrestrial
			days = 400
		}
		trigger_event = {
			id = wc_elemental_ritual_events.1110
			days = { 20 50 }
		}
	}

	after = {
		custom_tooltip = wc_elemental_ritual_events.1100.journey
	}
}

# Arrival on the Plane - Elements Welcome You
wc_elemental_ritual_events.1101 = { 
	title = wc_elemental_ritual_events.1100.title
	desc = {
		first_valid = {
			triggered_desc = { 
				trigger = {
					has_character_flag = wc_elements_used_force
				}
				desc = wc_elemental_rituals_events.1100.desc_forced
			}
			triggered_desc = { 
				trigger = {
					has_character_modifier = wc_elemental_sacrifice_modifier
				}
				desc = wc_elemental_rituals_events.1100.desc_sac
			}
		}
		desc = wc_elemental_ritual_events.1101.desc
	}
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	

	# all options lead to 1110
	# accept the gift of flame
	option = { 
		name = wc_elemental_ritual_events.1101.magic
		wc_change_amount_mp_effect = {
			CHANGE = add
			VALUE = 5
		}
		# grants magical power
	}
	# accept the gift of magma
	option = { 
		name = wc_elemental_ritual_events.1101.magma
		# solidifies into gold
		custom_tooltip = wc_elemental_ritual_events.1101.magma_gold
		add_short_term_gold = {
			100 300
		}
	}
	# graciously refuse their gifts
	option = { 
		name = wc_elemental_ritual_events.1101.none
		# gamble based on learning and diplomacy to get huge amounts of piety and prestige
		duel = {
			skills = { learning diplomacy }
			value = decent_skill_rating
			50 = {
				send_interface_message = {
					title = wc_elemental_ritual_events.1101.none_good
					add_piety = 500
					add_prestige = 1000
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
			}
		}
	}

	after = {
		custom_tooltip = wc_elemental_ritual_events.1100.journey
		trigger_event = {
			id = wc_elemental_ritual_events.1110
			days = { 10 20 }
		}
	}
}

# Journey through the Plane
wc_elemental_ritual_events.1110 = { 
	title = wc_elemental_ritual_events.1110.title
	desc = wc_elemental_ritual_events.1110.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	# all options lead to 1120
	# journey through the howling spires
	option = { 
		name = wc_elemental_ritual_events.1110.air
		custom_tooltip = wc_elemental_ritual_events.1110.air_tt
		# get bonuses related to air magic
		planar_journey_route_effect = { PLANE = fire MAGIC = elemental_air QUEST = spirit } 
	}
	# journey through the magma sea
	option = { 
		name = wc_elemental_ritual_events.1110.water
		custom_tooltip = wc_elemental_ritual_events.1110.water_tt
		# get bonuses related to water magic
		planar_journey_route_effect = { PLANE = fire MAGIC = elemental_water QUEST = spirit }
	}
	# journey through the erupting ranges
	option = { 
		name = wc_elemental_ritual_events.1110.earth
		custom_tooltip = wc_elemental_ritual_events.1110.earth_tt
		# get bonuses related to earth magic
		planar_journey_route_effect = { PLANE = fire MAGIC = elemental_earth QUEST = spirit }
	}
	# journey through the heartfire forest
	option = { 
		name = wc_elemental_ritual_events.1110.life
		custom_tooltip = wc_elemental_ritual_events.1110.life_tt
		# get bonuses related to life magic
		planar_journey_route_effect = { PLANE = fire MAGIC = life QUEST = spirit }
	}
	# journey though the great conflagration
	option = { 
		name = wc_elemental_ritual_events.1110.fire
		custom_tooltip = wc_elemental_ritual_events.1110.fire_tt
		add_character_flag = {
			flag = wc_ritual_fire_plane_elemental_fire_buffs
			days = 400
		}
		# get bonuses related to fire magic
		trigger_event = { 
			id = wc_elemental_ritual_events.1120
			days = { 30 60 }
		}
	}
}

# Outside the Firelord's Palace
wc_elemental_ritual_events.1120 = { 
	title = wc_elemental_ritual_events.1120.title
	desc = wc_elemental_ritual_events.1120.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	

	# wowwww palace is so cooooool XD
	option = { 
		name = {
			text = {
				first_valid = {
					triggered_desc = { 
						trigger = {
							OR = {
								has_trait = craven
								has_trait = shy
							}
						}
						desc = wc_elemental_ritual_events.1102.scared
					}
					triggered_desc = { 
						trigger = {
							OR = {
								has_trait = arrogant
								has_trait = cynical
							}
						}
						desc = wc_elemental_ritual_events.1102.idc
					}
					triggered_desc = {
						desc = wc_elemental_ritual_events.1102.wow
					}
				}
			}
		}
	}

	after = {
		trigger_event = {
			id = wc_elemental_ritual_events.1200
			days = { 60 90 }
		}
	}
}

# Welcomed into the Palace
wc_elemental_ritual_events.1200 = { 
	title = wc_elemental_ritual_events.1200.title
	desc = wc_elemental_ritual_events.1200.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	

	option = { # Ask for Protection - taken from old event
		name = magic_lifestyle.1002.protection
		random_list = {
			50 = {
				desc = wc_gift_power_big
				modifier = {
					add = 15
					has_character_flag = wc_ritual_fire_plane_elemental_fire_buffs
				}
				add_character_modifier = {
					modifier = wc_elemental_fire_major_protection_modifier
					days = wc_spell_planar_fire_duration_days_value
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -49
				}
			}
			50 = {
				add_character_modifier = {
					modifier = wc_elemental_fire_minor_protection_modifier
					days = wc_spell_planar_fire_duration_days_value
				}
				desc = wc_gift_power_good
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -49
				}
			}
		}
		if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_fire_buffs
			}
			wc_add_magic_resistance_effect = {
				MAGIC = elemental_water
				VALUE = 2
				CHANGE = add
			}
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_air_buffs
			}
			wc_add_magic_resistance_effect = {
				MAGIC = elemental_earth
				VALUE = 2
				CHANGE = add
			}
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_water_buffs
			}
			wc_add_magic_resistance_effect = {
				MAGIC = elemental_fire
				VALUE = 2
				CHANGE = add
			}
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_earth_buffs
			}
			wc_add_magic_resistance_effect = {
				MAGIC = elemental_air
				VALUE = 2
				CHANGE = add
			}
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_life_buffs
			}
			wc_add_magic_resistance_effect = {
				MAGIC = death
				VALUE = 2
				CHANGE = add
			}
		}
	}
	option = { # Ask for Efficiency - taken from old event
		name = magic_lifestyle.1002.efficiency
		random_list = {
			50 = {
				desc = wc_gift_power_big
				add_character_modifier = {
					modifier = wc_elemental_fire_major_efficiency_modifier
					days = wc_spell_planar_fire_duration_days_value
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -49
				}
			}
			50 = {
				add_character_modifier = {
					modifier = wc_elemental_fire_minor_efficiency_modifier
					days = wc_spell_planar_fire_duration_days_value
				}
				desc = wc_gift_power_good
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -49
				}
			}
		}
		if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_fire_buffs
			}
			wc_add_magic_boost_modifier = {
				MAGIC = elemental_fire
				DAYS = 365
			}
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_air_buffs
			}
			wc_add_magic_boost_modifier = {
				MAGIC = elemental_air
				DAYS = 365
			}
			add_elemental_air_magic_lifestyle_perk_points = 1
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_water_buffs
			}
			wc_add_magic_boost_modifier = {
				MAGIC = elemental_water
				DAYS = 365
			}
			add_elemental_water_magic_lifestyle_perk_points = 1
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_elemental_earth_buffs
			}
			wc_add_magic_boost_modifier = {
				MAGIC = elemental_earth
				DAYS = 365
			}
			add_elemental_earth_magic_lifestyle_perk_points = 1
		}
		else_if = {
			limit = {
				has_character_flag = wc_ritual_fire_plane_life_buffs
			}
			wc_add_magic_boost_modifier = {
				MAGIC = life
				DAYS = 365
			}
			add_life_magic_lifestyle_perk_points = 1
		}
	}
	option = { # Ask for Companionship - taken from old event ( this one sucks af )
		name = magic_lifestyle.1002.companionship
		trigger = {
			has_court_position = court_mage_court_position
		}
		random_list = {
			50 = {
				add_character_flag = {
					flag = elements_listen
					days = 10
				}
				desc = wc_gift_power_big
				add_character_modifier = {
					modifier = wc_elemental_fire_major_companionship_modifier
					days = wc_spell_planar_fire_duration_days_value
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -49
				}
			}
			50 = {
				add_character_modifier = {
					modifier = wc_elemental_fire_minor_companionship_modifier
					days = wc_spell_planar_fire_duration_days_value
				}
				desc = wc_gift_power_good
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = -49
				}
			}
		}
		court_position:court_mage_court_position = {
			if = {
				limit = {
					root = { has_character_flag = wc_ritual_fire_plane_elemental_fire_buffs }
				}
				wc_add_magic_boost_modifier = {
					MAGIC = elemental_fire
					DAYS = 365
				}
				add_elemental_fire_magic_lifestyle_perk_points = 1
			}
			else_if = {
				limit = {
					root = { has_character_flag = wc_ritual_fire_plane_elemental_air_buffs }
				}
				wc_add_magic_boost_modifier = {
					MAGIC = elemental_air
					DAYS = 365
				}
				add_elemental_air_magic_lifestyle_perk_points = 1
			}
			else_if = {
				limit = {
					root = { has_character_flag = wc_ritual_fire_plane_elemental_water_buffs }
				}
				wc_add_magic_boost_modifier = {
					MAGIC = elemental_water
					DAYS = 365
				}
				add_elemental_water_magic_lifestyle_perk_points = 1
			}
			else_if = {
				limit = {
					root = { has_character_flag = wc_ritual_fire_plane_elemental_earth_buffs }
				}
				wc_add_magic_boost_modifier = {
					MAGIC = elemental_earth
					DAYS = 365
				}
				add_elemental_earth_magic_lifestyle_perk_points = 1
			}
			else_if = {
				limit = {
					root = { has_character_flag = wc_ritual_fire_plane_life_buffs }
				}
				wc_add_magic_boost_modifier = {
					MAGIC = life
					DAYS = 365
				}
				add_life_magic_lifestyle_perk_points = 1
			}
		}
	}

	after = {
		trigger_event = { 
			id = wc_elemental_ritual_events.1210
			days = { 30 45 }
		}
	}
}

# Audience with the Firelord
wc_elemental_ritual_events.1210 = { 
	title = wc_elemental_ritual_events.1210.title
	desc = wc_elemental_ritual_events.1210.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	# Mastery over Fire Magic
	option = { 
		name = wc_elemental_ritual_events.1210.mastery
		if = { # Already Finished all perks
			limit = {
				AND = {
					perks_in_tree = { tree = elemental_fire_magic_tree_1 value >= 9 }
					perks_in_tree = { tree = elemental_fire_magic_tree_2 value >= 9 }
				}
			}
			add_character_modifier = {
				modifier = wc_fire_magic_blessing_modifier
			}
			add_character_modifier = {
				modifier = wc_backdraft_proc_modifier
			}
			if = {
				limit = {
					NOT = {
						has_variable = wc_fire_magic_blessing_var
					}
				}
				set_variable = {
					name = wc_fire_magic_blessing_var
					value = 0
				}
			}
			change_variable = {
				name = wc_fire_magic_blessing_var
				add = 1
			}
		}
		else = { # Get 1 perk unlock
			add_elemental_fire_magic_lifestyle_perk_points = 1
		}
	}

	# Peace in my realm (must be at war)
	option = { 
		name = wc_elemental_ritual_events.1210.peace

		trigger = {
			is_at_war = yes
		}
		every_character_war = {
			end_war = white_peace
		}
	}

	# Power (must not be independent)
	option = { 
		name = wc_elemental_ritual_events.1210.power
		trigger = {
			NOT = {
				is_independent_ruler = yes
			}
			highest_held_title_tier <= tier_duchy
		}
		create_title_and_vassal_change = {
			type = granted
			save_scope_as = change
			add_claim_on_loss = yes
		}
		liege.primary_title = {
			change_title_holder_include_vassals = {
				holder = root
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change
		stress_impact = {
			ambitious = medium_stress_impact_loss
			greedy = medium_stress_impact_loss
			compassionate = medium_stress_impact_gain
		}
	}

	# Funds
	option = { 
		name = wc_elemental_ritual_events.1210.funds
		stress_impact = {
			greedy = major_stress_impact_loss
		}
		add_short_term_gold = 500
	}
	
	# My enemies to suffer
	option = {
		name = wc_elemental_ritual_events.1210.mean
		trigger = {
			OR = {
				has_trait = vengeful
				has_trait = wrathful
			}
			OR = {
				any_relation = {
					type = potential_rival
					count >= 1
				}
				any_relation = {
					type = rival
					count >= 1
				}
				any_relation = {
					type = nemesis
					count >= 1
				}
			}
		}
		every_relation = {
			type = potential_rival
			add_to_temporary_list = people_to_hurt_list
		}
		every_relation = {
			type = rival
			add_to_temporary_list = people_to_hurt_list
		}
		every_relation = {
			type = nemesis
			add_to_temporary_list = people_to_hurt_list
		}
		every_in_list = {
			list = people_to_hurt_list
			random_list = {
				15 = { # They lose money, prestige
					remove_short_term_gold = 750
					add_prestige = -1000
					add_prestige = 1000
					add_short_term_gold = 750
					stress_impact = {
						greedy = medium_stress_impact_loss
					}
				}
				10 = { # All of their secrets get exposed
					trigger = {
						any_secret = {
							count >= 1
						}
					}
					custom_tooltip = all_secrets_exposed_tt
					hidden_effect = {
						every_secret = {
							expose_secret = root
						}
					}
				}
				10 = { # Their heir dies
					trigger = {
						exists = designated_heir
					}
					designated_heir = {
						override_death_effect = {
							death_reason = death_vanished
						}
					}
				}
				10 = { # Their spouse or lover dies
					trigger = {
						exists = primary_partner
					}
					primary_partner = {
						override_death_effect = {
							death_reason = death_vanished
						}
					}
				}
				20 = { # They get injured
					if = {
						limit = {
							NOT = { has_trait = burned_2 }
						}
						add_trait = burned_2
					}
				}
				5 = { # They Die
					override_death_effect = {
						death_reason = death_vanished
					}
				}
			}
		}
		stress_impact = {
			compassionate = major_stress_impact_gain
			vengeful = major_stress_impact_loss
			wrathful = minor_stress_impact_loss
		}
	}
	after = {
		trigger_event = { 
			id = wc_elemental_ritual_events.1220
			days = { 30 45 }
		}
	}
}

# Feast of Elemental Fire
wc_elemental_ritual_events.1220 = { 
	title = wc_elemental_ritual_events.1220.title
	desc = wc_elemental_ritual_events.1220.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	immediate = {
		stress_impact = {
			base = medium_stress_impact_loss
		}
	}
	# Eat the Magma Loaf 
	option = { 
		name = wc_elemental_ritual_events.1220.loaf
		add_character_flag = {
			flag = feast_loaf
			days = 10
		}
	}

	# Drink Inferno-infused Eggnog
	option = {
		name = wc_elemental_ritual_events.1220.eggnog
		add_character_flag = {
			flag = feast_eggnog
			days = 10
		}
	}

	# Try the combustible burger (lol) 
	option = {
		name = wc_elemental_ritual_events.1220.burger
		add_character_flag = {
			flag = feast_burger
			days = 10
		}
	}

	# Have a slice of Ash Cake 
	option = {
		name = wc_elemental_ritual_events.1220.cake
		add_character_flag = {
			flag = feast_cake
			days = 10
		}
	}

	# Try some of everything
	option = { 
		name = wc_elemental_ritual_events.1220.fat
		trigger = {
			has_trait = gluttonous
		}
		stress_impact = {
			gluttonous = major_stress_impact_loss
		}
		add_character_flag = {
			flag = feast_fat
			days = 10
		}
	}

	# The actual effect is almost random each time, options are just flavor
	after = {
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						has_character_flag = feast_fat
					}
				}
				set_variable = {
					name = elemental_fire_cycle_mult
					value = 2
					days = 30
				}
				random_list = {
					25 = {
						modifier = {
							add = 10
							has_character_flag = feast_eggnog
						}
						modifier = {
							add = -100
							AND = {
								has_character_flag = wc_ritual_fire_plane_elemental_fire_buffs
								perks_in_tree = { tree = elemental_fire_magic_tree_1 value >= 9 }
								perks_in_tree = { tree = elemental_fire_magic_tree_2 value >= 9 }
							}
						}
						if = {
							limit = {
								has_character_flag = wc_ritual_fire_plane_elemental_fire_buffs
							}
							add_elemental_fire_magic_lifestyle_xp = 500
						}
						else_if = {
							limit = {
								has_character_flag = wc_ritual_fire_plane_elemental_air_buffs
							}
							add_elemental_air_magic_lifestyle_xp = 500
						}
						else_if = {
							limit = {
								has_character_flag = wc_ritual_fire_plane_elemental_water_buffs
							}
							add_elemental_water_magic_lifestyle_xp = 500
						}
						else_if = {
							limit = {
								has_character_flag = wc_ritual_fire_plane_elemental_earth_buffs
							}
							add_elemental_earth_magic_lifestyle_xp = 500
						}
						else_if = {
							limit = {
								has_character_flag = wc_ritual_fire_plane_life_buffs
							}
							add_life_magic_lifestyle_xp = 500
						}
					}
					25 = {
						modifier = {
							add = 10
							has_character_flag = feast_loaf
						}
						add_character_modifier = {
							modifier = wc_elemental_fire_love_me_modifier
							days = 400
						}
					}
					25 = {
						modifier = {
							add = 10
							has_character_flag = feast_burger
						}
						add_character_modifier = {
							modifier = wc_elemental_fire_fear_me_modifier
							days = 400
						}
					}
					25 = {
						modifier = {
							add = 10
							has_character_flag = feast_cake
						}
						add_short_term_gold = 300
						add_prestige = 500
						add_piety = 500
						if = {
							limit = {
								exists = liege
							}
							add_hook = {
								target = liege
								type = favor_hook
							}
						}
						else_if = {
							limit = {
								exists = faith.religious_head
							}
							add_hook = {
								target = faith.religious_head
								type = favor_hook
							}
						}
						else_if = {
							limit = {
								any_vassal_or_below = {
									count >= 1
								}
							}
							random_vassal_or_below = {
								save_scope_as = vas
								root = {
									add_hook = {
										target = scope:vas
										type = favor_hook
									}
								}
							}
						}
						else_if = {
							limit = {	
								any_relation = {
									type = rival
									count >= 1
								}
							}
							random_relation = {
								type = rival
								save_scope_as = vas
								root = {
									add_hook = {
										target = scope:vas
										type = favor_hook
									}
								}
							}
						}
					}
				}
			}
			else = { # get everything but diminished
				set_variable = {
					name = elemental_fire_cycle_mult
					value = 0.85
					days = 30
				}
				if = {
					limit = {
						has_character_flag = wc_ritual_fire_plane_elemental_fire_buffs
					}
					add_elemental_fire_magic_lifestyle_xp = 50
				}
				else_if = {
					limit = {
						has_character_flag = wc_ritual_fire_plane_elemental_air_buffs
					}
					add_elemental_air_magic_lifestyle_xp = 50
				}
				else_if = {
					limit = {
						has_character_flag = wc_ritual_fire_plane_elemental_water_buffs
					}
					add_elemental_water_magic_lifestyle_xp = 50
				}
				else_if = {
					limit = {
						has_character_flag = wc_ritual_fire_plane_elemental_earth_buffs
					}
					add_elemental_earth_magic_lifestyle_xp = 50
				}
				else_if = {
					limit = {
						has_character_flag = wc_ritual_fire_plane_life_buffs
					}
					add_life_magic_lifestyle_xp = 50
				}
				add_character_modifier = {
					modifier = wc_elemental_fire_love_me_modifier
					days = 100
				}
				add_character_modifier = {
					modifier = wc_elemental_fire_fear_me_modifier
					days = 100
				}
				add_short_term_gold = 50
				add_prestige = 100
				add_piety = 100
			}
		}
		trigger_event = {
			id = wc_elemental_ritual_events.1300
			days = { 30 60 }
		}
	}
}

# Return Home from the Elemental Plane of Fire
wc_elemental_ritual_events.1300 = { 
	title = wc_elemental_ritual_events.1300.title
	desc = wc_elemental_ritual_events.1300.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	# Get some bonus related to Fire Elemental
	immediate = {
		add_character_modifier = {
			modifier = wc_elemental_fire_planar_fire_modifier
			years = 1
		}
		create_character = { 
			template = planar_fire_character_spirit
			location = root.location
			save_scope_as = planar_fire_champion
		}
	}

	# Terrestrial (if has one)
	option = { 
		name = wc_elemental_ritual_events.1300.terrestrial
		trigger = {
			has_character_flag = wc_ritual_terrestrial
		}
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = wc_planar_fire_army
			men_at_arms = {
				type = fire_terrestrial
				stacks = 5
			}
			location = root.capital_province
		}
	}

	# Next planar fire cost no mana / no cast time (can only use once in life)
	option = { 
		name = wc_elemental_ritual_events.1300.mana
		trigger = {
			NOT = {
				has_character_flag = wc_used_free_planar_fire
			}
		}
		custom_tooltip = wc_elemental_ritual_events.1300.mana.tt
		add_character_flag = wc_has_free_planar_fire
	}

	# A magic-proficient champion
	option = { 
		name = wc_elemental_ritual_events.1300.champion
		scope:planar_fire_champion = {
			set_employer = root
		}
	}

	# Your wisdom is enough.
	option = {
		name = wc_elemental_ritual_events.1300.lazy
		wc_change_amount_element_favour_effect = {
			ELEMENT = elemental_fire
			CHANGE = add
			VALUE = 20
		}
	}

	after = {
		trigger_event = {
			id = wc_elemental_ritual_events.1310 
			days = { 5 10 }
		}
	}
}

# End of the questline
wc_elemental_ritual_events.1310 = { 
	title = wc_elemental_ritual_events.1310.title
	desc = wc_elemental_ritual_events.1310.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	immediate = {
		if = {
			limit = {
				has_character_flag = wc_has_free_planar_fire
			}
			remove_character_flag = wc_has_free_planar_fire
			add_character_flag = wc_used_free_planar_fire
		}
	}

	option = { 
		name = wc_elemental_ritual_events.1310.a
	}
}


######################################
# 1500 - 1999
# Fire Ritual (Decay)
######################################
# Prepare the invasion
wc_elemental_ritual_events.1501 = { 
	title = wc_elemental_ritual_events.1501.title
	desc = wc_elemental_ritual_events.1501.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	right_portrait = {
		character = root
		animation = thinking
	}

	immediate = {
		set_variable = {
			name = wc_decay_ritual_elemental_loyalty
			value = 50
		}
	}

	# proceed -> 1502
	option = {
		name = wc_elemental_ritual_events.1501.a
		trigger_event = { 
			id = wc_elemental_ritual_events.1502
			days = { 20 30 }
		}
	}

	# cancel -> 1505
	option = {
		name = wc_elemental_ritual_events.1001.b
		trigger_event = { 
			id = wc_elemental_ritual_events.1505
			days = 1
		}
	}
}

# Open the portal
wc_elemental_ritual_events.1502 = { 
	title = wc_elemental_ritual_events.1502.title
	desc = wc_elemental_ritual_events.1502.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	right_portrait = {
		character = root
		animation = marshal
	}

	# call on air spirits for additional aid, all air spells go on cooldown
	option = { 
		name = wc_elemental_ritual_events.1502.air
		name = wc_elemental_ritual_events.1502.air
		trigger = { 
			wc_elemental_air_favour_current_value < wc_decay_elemental_favour_threshold_value
			OR = { 
				perks_in_tree = { tree = elemental_air_magic_tree_1 value > 5 }
				perks_in_tree = { tree = elemental_air_magic_tree_2 value > 5 }
			}
		}
	}

	#call on earth spirits for additional aid, all earth spells go on cooldown
	option = { 
		name = wc_elemental_ritual_events.1502.earth
		trigger = { 
			wc_elemental_earth_favour_current_value < wc_decay_elemental_favour_threshold_value
			OR = { 
				perks_in_tree = { tree = elemental_earth_magic_tree_1 value > 5 }
				perks_in_tree = { tree = elemental_earth_magic_tree_2 value > 5 }
			}
		}
	}

	#call on water spirits for additional aid, all water spells go on cooldown
	option = { 
		name = wc_elemental_ritual_events.1502.water
		custom_tooltip = wc_water_spirits_cd
		trigger = { 
			OR = { 
				perks_in_tree = { tree = elemental_water_magic_tree_1 value > 3 }
				perks_in_tree = { tree = elemental_water_magic_tree_2 value > 3 }
			}
		}
		wc_change_amount_element_favour_effect = {
			ELEMENT = elemental_water
			CHANGE = subtract
			VALUE = 10
		}
		random_list = {
			50 = {
				modifier = {
					add = 10
					wc_elemental_water_favour_current_value < wc_decay_elemental_favour_threshold_value
				}

				trigger_event = {
					id = wc_elemental_ritual_events.1601
					days = 3
				}
				custom_tooltip = wc_ritual_portal_success
			}
			40 = {
				modifier = {
					add = wc_elemental_water_favour_current_value
					is_alive = yes
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1503
					days = 3
				}
				custom_tooltip = wc_ritual_portal_fail
			}
		}
	}

	#hope you have enough aid 
	option = { 
		name = wc_elemental_ritual_events.1502.none
		random_list = {
			50 = {
				modifier = {
					add = 5
					wc_elemental_fire_favour_current_value < wc_decay_elemental_favour_threshold_value
				}

				trigger_event = {
					id = wc_elemental_ritual_events.1601
					days = 3
				}
				custom_tooltip = wc_ritual_portal_success
			}
			40 = {
				modifier = {
					add = wc_elemental_fire_favour_current_value
					is_alive = yes
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1503
					days = 3
				}
				custom_tooltip = wc_ritual_portal_fail
			}
		}
	}
}


# Portal is unstable
wc_elemental_ritual_events.1503 = { 
	title = wc_elemental_ritual_events.1503.title
	desc = wc_elemental_ritual_events.1503.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	immediate = {
		stress_impact = {
			base = minor_stress_impact_gain
		}
	}

	right_portrait = {
		character = root
		animation = worry
	}

	# keep going -> 1601
	option = { 
		name = wc_elemental_ritual_events.1503.a
		# Decreases future army size slightly
		change_variable = {
			name = wc_decay_ritual_elemental_loyalty
			add = { -5 -15 }
		}
		trigger_event = { 
			id = wc_elemental_ritual_events.1601
			days = { 5 10 }
		}
	}

	# cancel -> 1505
	option = {
		name = wc_elemental_ritual_events.1001.b
		trigger_event = { 
			id = wc_elemental_ritual_events.1505
			days = 1
		}
	}
}

# Cancel the invasion (following 1501 or 1503)
wc_elemental_ritual_events.1505 = { 
	title = wc_elemental_ritual_events.1505.title
	desc = wc_elemental_ritual_events.1505.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	

	option = { 
		name = wc_elemental_ritual_events.1005.a
		# remove some of the cd
		if = {
			limit = {
				has_variable = planar_fire_cd
			}
			change_variable = {
				name = planar_fire_cd
				add = -1000
			}
		}
		wc_change_amount_element_favour_effect = {
			ELEMENT = elemental_fire
			CHANGE = subtract
			VALUE = 10
		}
		remove_character_flag = any_ritual_cd
	}
}

# Establish a beachhead
wc_elemental_ritual_events.1601 = { 
	title = wc_elemental_ritual_events.1601.title
	desc = wc_elemental_ritual_events.1601.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	right_portrait = {
		character = root
		animation = personality_bold
	}

	# can lead to 1602 (lose) or 1605 (win) depending on magical prowess and army size
	option = { 
		name = wc_elemental_ritual_events.1601.opt.a
		duel = {
			skill = martial
			value = decent_skill_rating
			50 = {
				modifier = {
					add = wc_mp_value
					is_alive = yes
				}
				modifier = {  
					add = death_magic_lifestyle_perks 
					death_magic_lifestyle_perks > 0 
				}
				modifier = {
					factor =  1.5
					wc_elemental_air_favour_current_value <= wc_decay_elemental_favour_threshold_value
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_elements_submit
				trigger_event = {
					id = wc_elemental_ritual_events.1605
					days = { 60 100 }
				}
								# Increase army size "loyalty"
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = 50
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				modifier = {
					factor = 1.5
					wc_elemental_air_favour_current_value >= wc_spirit_elemental_favour_threshold_value
				}
				modifier = {  
					add = life_magic_lifestyle_perks 
					life_magic_lifestyle_perks > 0
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				custom_tooltip = wc_elements_oppose
				trigger_event = {
					id = wc_elemental_ritual_events.1602
					days = { 60 100 }
				}
			}
		}
	}
}

# Elementals oppose you
wc_elemental_ritual_events.1602 = { 
	title = wc_elemental_ritual_events.1602.title
	desc = wc_elemental_ritual_events.1602.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	right_portrait = {
		character = root
		animation = personality_bold
	}
	
	# all options lead to 1605
	# meet them in battle (Martial & Prowess)
	option = { 
		name = wc_elemental_ritual_events.1602.opt.a
		duel = {
			skills = { martial prowess }
			value = decent_skill_rating
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_elemental_ritual_events.1602.win_big
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 25 50 }
				}
			}
			50 = {
				custom_tooltip = wc_elemental_ritual_events.1602.win
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 5 30 }
				}
			}
		}
	}

	# kill them personally until they submit (Prowess & Dread)
	option = {
		name = wc_elemental_ritual_events.1602.opt.b
		duel = {
			skill = prowess
			value = decent_skill_rating
			40 = {
				modifier = {
					add = dread
					dread > 0 
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_elemental_ritual_events.1602.win_big
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 25 50 }
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}				custom_tooltip = wc_elemental_ritual_events.1602.win
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 5 30 }
				}
			}
		}
	}

	# assassinate any who oppose you (Intrigue & Dread)
	option = { 
		name = wc_elemental_ritual_events.1602.opt.c
		duel = {
			skill = intrigue
			value = decent_skill_rating
			40 = {
				modifier = {
					add = dread
					dread > 0 
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_elemental_ritual_events.1602.win_big
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 25 50 }
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				custom_tooltip = wc_elemental_ritual_events.1602.win
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 5 30 }
				}
			}
		}
	}

	after = {
		trigger_event = {
			id = wc_elemental_ritual_events.1605
			days = { 60 100 }
		}
	}
}

# Elementals submit to you, some are not usable on the material plane
wc_elemental_ritual_events.1605 = { 
	title = wc_elemental_ritual_events.1605.title
	desc = wc_elemental_ritual_events.1605.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	# Determine army strength here
	immediate = {
		# Using decay values
		if = {
			limit = {
				wc_elemental_fire_favour_current_value < wc_decay_elemental_favour_threshold_value
			}
			change_variable = {
				name = wc_decay_ritual_elemental_loyalty
				add = { 10 25 }
			}
		}
		else_if = {
			limit = {
				wc_elemental_fire_favour_current_value < -10
			}
			change_variable = {
				name = wc_decay_ritual_elemental_loyalty
				add = { 5 15 }
			}
		}
		else_if = {
			limit = {
				wc_elemental_fire_favour_current_value <= 0
			}
			change_variable = {
				name = wc_decay_ritual_elemental_loyalty
				add = 5
			}
		}
		else_if = {
			limit = {
				wc_elemental_fire_favour_current_value >= 0
			}
			change_variable = {
				name = wc_decay_ritual_elemental_loyalty
				add = { -5 -15 }
			}
		}
		create_character = {
			template = mage_elemental_fire_character
			location = root.location
			save_scope_as = elemental_fire_mage
		}
		create_character = {
			template = mage_elemental_fire_character
			location = root.location
			save_scope_as = elemental_fire_mage_2
		}
		create_character = {
			template = mage_elemental_fire_character
			location = root.location
			save_scope_as = elemental_fire_mage_3
		}
	}

	# all options lead to 1610
	# everything based on loyalty variable
	# use them to bolster your army in the elemental plane
	option = { 
		# Gain maa 
		name = wc_elemental_ritual_events.1605.opt.a
		change_variable = {
			name = wc_decay_ritual_elemental_loyalty
			add = 15
		}
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = wc_planar_fire_army
			men_at_arms = {
				type = fire_terrestrial
				stacks = 5
			}
			location = root.capital_province
		}
	}

	left_portrait = {
		character = scope:elemental_fire_mage
		animation = idle
	}

	right_portrait = {
		character = root
		animation = thinking
	}

	# bring them back to the material plane as slaves
	option = {
		# gain gold, elemental fire user courtiers
		name = wc_elemental_ritual_events.1605.opt.b
		add_short_term_gold = 150
		
		scope:elemental_fire_mage_3 = {
			set_employer = root
		}
		scope:elemental_fire_mage_2 = {
			set_employer = root
		}
		scope:elemental_fire_mage = {
			set_employer = root
		}
	}

	# feed off their power
	option = {
		name = wc_elemental_ritual_events.1605.opt.c
		# gain magical prowess, lifestyle xp, dread
		# Modifier gives all 3 of these things, but the magical prowess needs to be added in magical prowess script value
		add_character_modifier = {
			modifier = wc_fire_decay_ritual_feed_modifier
			years = 3
		}
		# It doesnt show on the modifier, so show it as a tooltip
		show_as_tooltip = {
			wc_change_amount_mp_effect = {
				CHANGE = add
				VALUE = 10
			}
		}
	}

	after = {
		trigger_event = { 
			id = wc_elemental_ritual_events.1610
			days = { 30 120 }
		}
	}
}

# Choose path
wc_elemental_ritual_events.1610 = { 
	title = wc_elemental_ritual_events.1610.title
	desc = wc_elemental_ritual_events.1610.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	

	# march across the howling spires
	option = { 
		name = wc_elemental_ritual_events.1610.air
		custom_tooltip = wc_elemental_ritual_events.1610.air_tt
		# get bonuses related to air magic
		planar_journey_route_effect = { PLANE = fire MAGIC = elemental_air QUEST = decay }
	}
	# march across the magma sea
	option = { 
		name = wc_elemental_ritual_events.1610.water
		custom_tooltip = wc_elemental_ritual_events.1610.water_tt
		# get bonuses related to water magic
		planar_journey_route_effect = { PLANE = fire MAGIC = elemental_water QUEST = decay }
	}
	# march across the erupting ranges
	option = { 
		name = wc_elemental_ritual_events.1610.earth
		custom_tooltip = wc_elemental_ritual_events.1610.earth_tt
		# get bonuses related to earth magic
		planar_journey_route_effect = { PLANE = fire MAGIC = elemental_earth QUEST = decay }
	}
	# march across the ashen pits
	option = { 
		name = wc_elemental_ritual_events.1610.death
		custom_tooltip = wc_elemental_ritual_events.1610.death_tt
		# get bonuses related to death magic
		planar_journey_route_effect = { PLANE = fire MAGIC = death QUEST = decay }
	}
	# journey though the great conflagration
	option = { 
		name = wc_elemental_ritual_events.1610.fire
		custom_tooltip = wc_elemental_ritual_events.1610.fire_tt
		# get bonuses related to fire magic
		trigger_event = { 
			id = wc_elemental_ritual_events.1620
			days = { 60 120 }
		}
	}
}

# arriving at the Firelord's Palace
wc_elemental_ritual_events.1620 = { 
	title = wc_elemental_ritual_events.1620.title
	desc = wc_elemental_ritual_events.1620.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	# victory shall be ours!
	option = { 
		name = wc_elemental_ritual_events.1620.opt.a
		custom_tooltip = wc_elemental_ritual_events.1620.opt.a_tt
		# yuppp
	}
# bro idk what u want me to put here
	# it's a bit... smaller.. than i imagined
	option = { 
		name = wc_elemental_ritual_events.1620.opt.b
		custom_tooltip = wc_elemental_ritual_events.1620.opt.b_tt
	}

	after = {
		trigger_event = {
			id = wc_elemental_ritual_events.1701
			days= { 20 60 }
		}
	}
}

# decide on your siege method
wc_elemental_ritual_events.1701 = { 
	title = wc_elemental_ritual_events.1701.title
	desc = {
		desc = wc_elemental_ritual_events.1701.desc.opening
		first_valid = {
			triggered_desc = { 
				trigger = {
					exists = cp:councillor_spymaster 
				}
				desc = wc_elemental_ritual_events.1701.desc.spymaster_real
			}
			desc = wc_elemental_ritual_events.1701.desc.spymaster_fake
		}
		desc = wc_elemental_ritual_events.1701.desc.spymaster
		first_valid = {
			triggered_desc = { 
				trigger = {
					exists = cp:councillor_marshal 
				}
				desc = wc_elemental_ritual_events.1701.desc.marshal_real
			}
			desc = wc_elemental_ritual_events.1701.desc.marshal_fake
		}
		desc = wc_elemental_ritual_events.1701.desc.marshal
	}

	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	immediate = {
		# Find spymaster or marshal, if not, find a courtier who is good at respective skill
		if = {
			limit = {
				exists = cp:councillor_spymaster 
			}
			cp:councillor_spymaster = {
				save_scope_as = spymaster
			}
		}
		else = {
			ordered_courtier_or_guest = {
				order_by = intrigue
				save_scope_as = spymaster
			}
		}
		if = {
			limit = {
				exists = cp:councillor_marshal
			}
			cp:councillor_marshal = {
				save_scope_as = marshal
			}
		}
		else = {
			ordered_courtier_or_guest = {
				order_by = martial
				save_scope_as = marshal
			}
		}
	}

	left_portrait = {
		character = scope:spymaster
		animation = thinking
	}

	right_portrait = {
		character = scope:marshal
		animation = marshal
	}

	# traditional siege method (martial + stewardship) -> long, low risk -> 1710
	option = { 
		name = wc_elemental_ritual_events.1701.opt.a
		duel = {
			skills = { martial stewardship }
			value = decent_skill_rating
			80 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_siege_continues_1
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 25 50 }
				}
				
				trigger_event = { 
					id = wc_elemental_ritual_events.1710
					days = { 60 120 }
				}
			}
			20 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				custom_tooltip = wc_siege_fails
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { -5 -10 }
				}
				add_character_flag = {
					flag = wc_ritual_failed_1
					days = 300
				}
				trigger_event = { 
					id = wc_elemental_ritual_events.1802
					days = { 60 120 }
				}
			}
		}
	}
		
	# stratagem of war (diplomacy + intrigue) -> medium, medium risk -> 1720
	option = { 
		name = wc_elemental_ritual_events.1701.opt.b
		duel = {
			skills = { diplomacy intrigue }
			value = decent_skill_rating
			70 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_siege_continues_2
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 25 50 }
				}
				add_character_flag = {
					flag = wc_ritual_stratagem
					days = 300
				}
				trigger_event = { 
					id = wc_elemental_ritual_events.1720
					days = { 30 60 }
				}
			}
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				custom_tooltip = wc_siege_fails
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { -10 -20 }
				}
				add_character_flag = {
					flag = wc_ritual_failed_2
					days = 300
				}
				trigger_event = { 
					id = wc_elemental_ritual_events.1802
					days = { 60 120 }
				}
			}
		}
	}

	# infiltration (martial + intrigue) -> short, high risk -> 1800 (success) or 1802 (failure)
	option = { 
		name = wc_elemental_ritual_events.1701.opt.c
		duel = {
			skills = { martial intrigue }
			value = decent_skill_rating
			40 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				add_character_flag = {
					flag = wc_ritual_infiltration
					days = 300
				}
				custom_tooltip = wc_siege_continues_3
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 25 50 }
				}
				trigger_event = { 
					id = wc_elemental_ritual_events.1730
					days = { 10 15 }
				}
			}
			60 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				custom_tooltip = wc_siege_fails
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { -15 -30 }
				}
				add_character_flag = {
					flag = wc_ritual_failed_3
					days = 300
				}
				trigger_event = { 
					id = wc_elemental_ritual_events.1802
					days = { 60 120 }
				}
			}
		}
		
	}
}

# breach the gates
wc_elemental_ritual_events.1710 = { 
	title = wc_elemental_ritual_events.1710.title
	desc = {
		desc = wc_elemental_ritual_events.1710.desc.opening
		first_valid = {
			triggered_desc = { 
				trigger = {
					var:wc_decay_ritual_elemental_loyalty >= 75
				}
				desc = wc_elemental_ritual_events.1710.desc.positive
			}
			triggered_desc = { 
				trigger = {
					var:wc_decay_ritual_elemental_loyalty >= 50
				}
				desc = wc_elemental_ritual_events.1710.desc.neutral
			}
			triggered_desc = { 
				trigger = {
					var:wc_decay_ritual_elemental_loyalty < 50
				}
				desc = wc_elemental_ritual_events.1710.desc.negative
			}
		}
		desc = wc_elemental_ritual_events.1710.desc.ending
	}
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	
	# You still proceed either way, it changes loyalty variable
	option = {
		name = wc_elemental_ritual_events.1710.opt.a
		duel = {
			skills = { diplomacy intrigue }
			value = decent_skill_rating
			60 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_siege_continues_1
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 5 15 }
				}
			}
			40 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				custom_tooltip = wc_siege_continues_difficulty
				add_character_flag = {
					flag = wc_ritual_failed_1
					days = 300
				}
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { -15 -5 }
				}
			}
		}
	}

	after = {
		trigger_event = {
			id = wc_elemental_ritual_events.1720
			days = { 10 30 }
		}
	}

}

# castle
wc_elemental_ritual_events.1720 = { 
	title = wc_elemental_ritual_events.1720.title
	desc = {
		first_valid = {
			triggered_desc = { 
				trigger = {
					has_character_flag = wc_ritual_stratagem
				}
				desc = wc_elemental_ritual_events.1720.desc.opening_stratagem
			}
			desc = wc_elemental_ritual_events.1720.desc.opening_normal
		}
		desc = wc_elemental_ritual_events.1720.desc.ending
	}
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }


	# Can actually lose this one
	option = {
		name = wc_elemental_ritual_events.1720.opt.a
		duel = {
			skills = { diplomacy intrigue }
			value = decent_skill_rating
			60 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_siege_continues_1
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 10 25 }
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1730
					days = { 10 30 }
				}
			}
			40 = { # Higher chance to lose if stratagem was used
				modifier = {
					add = 15
					has_character_flag = wc_ritual_stratagem
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				add_character_flag = {
					flag = wc_ritual_failed_2
					days = 300
				}
				custom_tooltip = wc_siege_fails
				trigger_event = {
					id = wc_elemental_ritual_events.1802
					days = { 10 30 }
				}
			}
		}
	}
}

# enter the sanctum and battle the firelord
wc_elemental_ritual_events.1730 = { 
	title = wc_elemental_ritual_events.1720.title
	desc = {
		first_valid = {
			triggered_desc = { 
				trigger = {
					has_character_flag = wc_ritual_infiltration
				}
				desc = wc_elemental_ritual_events.1730.desc.opening_infiltration
			}
			desc = wc_elemental_ritual_events.1730.desc.opening_normal
		}
		desc = wc_elemental_ritual_events.1730.desc.ending
	}
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	# Can actually lose this one
	option = {
		name = wc_elemental_ritual_events.1730.opt.a
		duel = {
			skills = { diplomacy intrigue }
			value = decent_skill_rating
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				custom_tooltip = wc_siege_continues_1
				change_variable = {
					name = wc_decay_ritual_elemental_loyalty
					add = { 15 25 }
				}
				trigger_event = {
					id = wc_elemental_ritual_events.1801
					days = { 10 30 }
				}
			}
			50 = { # Higher chance to lose if infiltration was used
				modifier = {
					add = 15
					has_character_flag = wc_ritual_infiltration
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				add_character_flag = {
					flag = wc_ritual_failed_3
					days = 300
				}
				if = {
					limit = {
						NOT = { has_character_flag = wc_ritual_infiltration }
					}
					add_character_flag = {
						flag = wc_ritual_partial
						days = 120
					}
				}
				custom_tooltip = wc_siege_fails
				trigger_event = {
					id = wc_elemental_ritual_events.1802
					days = { 10 30 }
				}
			}
		}
	}
}

# # accept the Firelord's surrender
# we not doing this ?
# wc_elemental_ritual_events.1800 = { 
# 	title = wc_elemental_ritual_events.1800.title
# 	desc = wc_elemental_ritual_events.1800.desc
# 	theme = elemental_fire
# 	override_background = { reference = bp1_bonfire }

# }


# return victorious with many elemental slaves
wc_elemental_ritual_events.1801 = { 
	title = wc_elemental_ritual_events.1801.title
	desc = wc_elemental_ritual_events.1801.desc
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }
	# get fire elementals
	# x loyalty amount fire tempests + buff modifier

	option = {
		name = wc_elemental_ritual_events.1801.opt
		add_character_modifier = {
			modifier = wc_elemental_fire_planar_fire_decay_win_modifier
			years = 2
		}
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = wc_planar_fire_army
			men_at_arms = {
				type = fire_elemental
				stacks = 2
			}
			men_at_arms = {
				type = fire_terrestrial
				stacks = 5
			}
			men_at_arms = {
				type = fire_tempest
				stacks = var:wc_decay_ritual_elemental_loyalty
			}
			location = root.capital_province
		}
	}
}

# defeated by firelord 
wc_elemental_ritual_events.1802 = { 
	title = wc_elemental_ritual_events.1802.title
	desc = { # Introduction based on when failed the siege
		first_valid = {
			triggered_desc = { 
				trigger = {
					has_character_flag = wc_ritual_failed_1
				}
				desc = wc_elemental_ritual_events.1802.desc.stage_town
			}
			triggered_desc = { 
				trigger = {
					has_character_flag = wc_ritual_failed_2
				}
				desc = wc_elemental_ritual_events.1802.desc.stage_sanctum
			}
			triggered_desc = { 
				trigger = {
					has_character_flag = wc_ritual_failed_3
				}
				desc = wc_elemental_ritual_events.1802.desc.stage_firelord
			}
		}
		first_valid = {
			triggered_desc = { # Partial thing
				trigger = {
					has_character_flag = wc_ritual_partial
				}
				desc = wc_elemental_ritual_events.1802.desc.degree_partial
			}
			triggered_desc = { # If failed from the first start, then it's awful and you get nothing
				trigger = {
					OR = {
						has_character_flag = wc_ritual_failed_1
						AND = {
							has_character_flag = wc_ritual_failed_2
							has_character_flag = wc_ritual_stratagem
						}
						AND = {
							has_character_flag = wc_ritual_failed_3
							has_character_flag = wc_ritual_infiltration
						}
					}
				}
				desc = wc_elemental_ritual_events.1802.desc.degree_awful
			}
			# Otherwise it's just bad, but you still get nothing
			desc = wc_elemental_ritual_events.1802.desc.degree_bad	
		}
	}

	immediate = {
		if = {
			limit = {
				OR = {
					has_character_flag = wc_ritual_failed_1
					AND = {
						has_character_flag = wc_ritual_failed_2
						has_character_flag = wc_ritual_stratagem
					}
					AND = {
						has_character_flag = wc_ritual_failed_3
						has_character_flag = wc_ritual_infiltration
					}
				}
			}
			add_character_flag = { # Increases cast time of next Planar Fire
				flag = wc_ritual_failed_awful
				years = 10
			}
		}
	}
	
	theme = elemental_fire
	override_background = { reference = bp1_bonfire }

	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = { 
						trigger = {
							OR = {
								has_character_flag = wc_ritual_failed_1
								AND = {
									has_character_flag = wc_ritual_failed_2
									has_character_flag = wc_ritual_stratagem
								}
								AND = {
									has_character_flag = wc_ritual_failed_3
									has_character_flag = wc_ritual_infiltration
								}
							}
						}
						desc = wc_elemental_ritual_events.1802.opt_awful
					}
					desc = wc_elemental_ritual_events.1802.opt
				}
			}
		}
		if = {
			limit = {
				NOR = {
					has_character_flag = wc_ritual_failed_1
					AND = {
						has_character_flag = wc_ritual_failed_2
						has_character_flag = wc_ritual_stratagem
					}
					AND = {
						has_character_flag = wc_ritual_failed_3
						has_character_flag = wc_ritual_infiltration
					}
				}
			}
			# get fire terrestrial
			# x loyalty amount fire tempests
			spawn_army = {
				uses_supply = no
				inheritable = yes
				name = wc_planar_fire_army
				men_at_arms = {
					type = fire_terrestrial
					stacks = 1
				}
				men_at_arms = {
					type = fire_tempest
					stacks = var:wc_decay_ritual_elemental_loyalty
				}
				location = root.capital_province
			}
		}
	}
}

######################################
# 2000 - 2499
# Water Ritual (Spirit)
######################################

# Waterside meditation? -- chill with the Snorks (https://youtu.be/jRJHu66k3a8) and become Aquaman?

######################################
# 2500 - 2999
# Water Ritual (Decay)
######################################

# Corrupting water & water elementals throughout Azeroth, maybe seeping into water plane

######################################
# 3000 - 3499
# Air Ritual (Spirit)
######################################

# go to heaven lol

######################################
# 3500 - 3999
# Air Ritual (Decay)
######################################

# Create a crazy thunderstorm, destruction, death, etc

######################################
# 4000 - 4499
# Earth Ritual (Spirit)
######################################

# Work with earth elementals to help heal the earth, build mountains, etc lol

######################################
# 4500 - 4999
# Earth Ritual (Decay)
######################################

# Attempt to great sundering 2 so you can get earth elementals

